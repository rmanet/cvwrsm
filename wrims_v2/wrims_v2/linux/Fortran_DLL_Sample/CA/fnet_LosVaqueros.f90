module fnet_LosVaqueros

! a = 0.00068547
! b = -0.015812

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-1.265945512817,-0.003232378066,0.178129234844,-0.229455447739,-0.086158350853,-0.698474502531,-0.100386315906,0.092576679516,0.179407261862,0.355891360233,0.377585593084,1.194289596334 &
            ,0.829098140963,-0.369942316192,-1.447013408031,0.088460192833,0.420809695447,0.437614543401,0.038003375689,0.176420782619,-0.341007815840,-0.005737201136,-0.053259388506,-0.254732967168 &
            ,0.268701479255,-1.255175999066,0.073767133613,-0.521409010320,-0.334179460716,-0.073012403886,-0.187690964024,-0.756025748316,0.406524445782,0.884325068292,0.990081805082,0.253298503010 &
            ,-0.185068250551,-0.768561466350,-0.997554060042,-0.265326487435,0.083075289791,-0.196811914652,0.078902303659,1.040257257329,0.807986201456,-0.264002094106,-1.442679577569,-0.390354036054 &
            ,0.218153283939,-0.309737816381,-0.266132930728,0.461571809117,0.444688916535,0.195739014436,-0.890217856555,-0.677892013817,-0.461768940067,0.891575508869,-0.206500888889,-0.509615247370 &
            ,0.878133742017,-0.207803492494,-0.078614086030,0.127358099116,-1.716663368642,1.075007751935,0.168112587477,0.017186016675,1.110698736884,-0.543298094222,-0.966407125615,0.327500827307 &
            ,0.880662676754,0.631552588573,1.694463785315,-1.793576173505,-0.243838936567,-1.310466851824,0.118788057041,0.161437820177,0.895486709591,-0.417239439007,0.433592332704,-1.223758728777 &
            ,-0.764690880066,-0.230111500318,0.976437185374,-0.029504164219,0.363756646012,-0.000901221327,0.109961529271,-0.103608977868,-0.327799486605,-0.085575014875,0.338782972698,0.075512887895 &
            ,-0.013202152752,1.374895063064,0.144386835725,-0.259582865756,0.016064815932,-0.065476837386,0.051108763821,0.029976041408,-0.377733213499,1.571844058799,0.025390290426,-0.638360065386 &
            ,0.321556565680,0.011682916936,0.117521993235,0.063860491306,-0.225276339615,3.421997540667,0.248044054096,-1.090796092122,0.064118673846,-0.093370442304,0.430372653574,0.124673464854 &
            ,-0.559586894840,1.948197847343,0.089877227256,-0.919011481906,0.734110152358,-0.060096191281,0.164207587748,0.333848830528,-0.033022442618,0.806305207761,0.049399542433,-0.010951749300 &
            ,0.002076257978,-0.039356083089,0.042086104767,0.043652062709,0.154516761393,0.112604340514,0.151996153396,-0.532139284920,0.347946088138,0.028921821174,0.450259495934,0.456876250417 &
            ,-0.078909813273,-1.531565201713,1.954135654040,-3.424864691511,-0.082493980589,-1.414462106474,1.342434967858,1.008690713705,0.913048922596,-1.604791990930,0.461924274664,-0.499729707311 &
            ,-0.575514019713,-0.128087476008,1.110784079918,0.760675362911,-0.182960169163,0.804770047588,-0.630912692958,-0.306457460481,-0.203152995946,0.169211314017,0.976485090540,0.592380066004 &
            ,-1.551654502724,-0.310074395691,0.612118794198,-2.374064239494,0.727586017039,-0.306408814921,-0.136320248759,0.229296624196,0.041090659371,-0.908632916424,-0.173555747184,-0.155503661343 &
            ,0.981513058410,0.228601429336,-0.828057031515,-0.385443615108,-0.779209431269,-0.062835358959,-0.380410325534,0.749507991969,0.000721534791,0.177127451209,0.399286741300,0.935561217575 &
            ,-1.312613944707,0.597926557710,-0.040805133510,-3.945102175867,0.521399221383,0.534282704754,1.719721892526,0.657448473071,1.928682725866,-0.531519606472,0.992984392130,-0.003544578238 &
            ,-0.859233693918,-0.284923088431,-0.748598692567,-0.621199144663,0.815293740350,-0.314568351665,-0.217276699000,-0.652919808415,-1.391381985561,0.728115780945,1.673657989931,0.559019913201 &
            ,1.064378098924,0.220191428423,0.899387054657,-0.606169767603,-0.798172346172,0.086511358726,0.232052178519,0.095727692548,-0.443073163536,0.233339149382,0.257168014310,-0.582769831062 &
            ,0.029138733265,-0.237722922383,-0.039649918877,-0.039534755358,0.104456470953,-0.050432022750,0.350230728704,-0.240240289497,-0.100757326844,-0.089664418807,0.033332642124,0.077379119215 &
            ,0.054187084969,-0.437979435888,0.296899939561,-0.384338120942,-0.059765366661,-0.156497759411,0.195343651899,0.174666935414,-0.030212903335,0.091255217490,0.077374708967,0.230070285893 &
            ,-0.163761239290,-0.065889269225,0.102448081010,0.222618441160,0.087281338505,-0.427430516420,0.120524447428,0.017615449069,-0.049858018131,0.045841693182,0.141665702007,0.126642189241 &
            ,0.036953169233,-0.584812016146,-0.112742716037,0.854227964989,-0.023328663745,0.048874302974,0.150870367878,0.520944278577,0.010986562911,-0.322886150628,0.127284064112,0.373651320031 &
            ,0.153099162959,-0.125884460097,-0.145913876445,0.200953159436,-0.495599410782,-0.010216322732,0.179967146848,0.714460140813,0.533593914990,-0.336409259930,-0.707726431770,0.266887261181 &
            ,-0.795867238836,1.174207482169,-0.238096790413,0.882066992327,1.761178133229,0.272708455076,-1.773267042728,-0.446636523956,-1.164569410170,0.737861022692,-0.459605601065,1.289219522269 &
            ,1.176736179822,0.343480520783,-1.347202106972,-0.134119697747,-0.131002340751,1.833605906368,-0.267766823327,2.709882363802,1.761897813426,0.393421541978,-1.546231010952,0.452107716343 &
            ,0.094281155195,-0.412734783901,-0.309767595489,1.020068870988,0.249051930436,0.175304138105,-0.424489997950,-0.257468105462,1.486471898623,0.194542452406,-0.255966665384,0.723710221364 &
            ,-0.502190662953,0.513269060373,0.905822987262,0.103255370673,1.795890100966,-1.771416501829,-0.081608202087,-1.588430273671,-2.275622198541,0.039761581298,2.508552921554,-0.286639303515 &
            ,2.068037145425,0.432110704828,-0.128107104452,-1.279132588142,-1.552802823392,0.367196893499,1.932839671081,-0.319079121099,0.759186996838,-0.552490511858,-0.248750623156,-2.878533130830 &
            ,-2.000711410365,0.303860272370,2.210416919756,-0.711265457300,0.084861534392,3.546454313321,0.219956772951,1.287867463559,0.120024952840,-0.101417416269,-0.129918550495,1.134303305783 &
            ,-1.285739326379,2.478540548121,0.125210472598,2.192196639022,1.061878081842,-0.529705739520,-1.847906096813,0.764473881683,-0.105834493502,-0.026317993639,-0.095956780733,0.254915287265 &
            ,-0.019973340577,-0.021773427202,-0.074163082431,0.041955730215,0.094549190673,0.482185585124,0.119878223246,0.508668509279,0.092394872716,-0.069591865416,-0.231918823967,0.174024322273 &
            ,-0.154106047230,0.226289473811,-0.032106099734,0.094139944478,0.024731949240,0.000287606890,-0.124214380334,0.011696561232,-0.395342296984,0.356417305970,-0.025368573680,0.247655868161 &
            ,0.268218419483,-0.045914606907,-0.198427296463,0.193407954291,0.118407360043,0.216242159646,0.054740596961,0.326006762826,0.005914386103,-0.013372243783,-0.135404972728,0.083315404126 &
            ,-0.027931995627,0.181441435854,-0.027339178826,0.153121441214,0.042549401429,0.009781074370,-0.031272697716,0.052239413994,-0.276458246749,0.030259221270,0.022826166283,-0.060543874040 &
            ,0.107997001854,-0.102448968324,-0.060371924573,0.075217889631,0.169075802678,0.353169097299,0.041985780709,0.047502348098,-0.098117600054,0.136757889084,-0.011208245691,-0.046041678455 &
            ,-2.040190668433,-0.432442315385,-0.649843319188,1.012395749465,-1.192988371393,-1.813949712429,0.894577029589,0.509117546966,0.392183258794,1.667024278967,0.700234228371,-0.293524017097 &
            ,1.653230143737,0.427965433218,-1.673773379797,-0.595161924907,-2.918629039322,0.477652408466,-0.574365731710,0.275109115547,0.360711927767,-0.572341986424,-0.370480553186,-0.233816555503 &
            ,-1.381338943719,-0.080963791559,-1.643991642153,-0.705704755448,1.241908019484,-0.400229136829,-1.782773171335,-2.478520089355,-0.226895594403,0.281729466858,0.625326657998,1.751446516142 &
            ,0.887329130049,-0.167510086412,-2.237549065988,-1.338643395630,2.837896035188,0.232670261698,-0.144342841429,2.193764601733,0.382434441484,0.090439954214,-0.899135631141,-1.046363722378 &
            ,2.812393666460,-1.165695807308,-2.055414613939,3.886543409836,-1.963026705550,1.515509456741,2.196680944678,-0.795112279413,-0.930475491143,0.404276413803,-3.204929043746,2.551131577352 &
            ,-0.611823614811,-1.542050669969,1.779367544376,-3.872023950107,-2.584405225828,-0.853522932448,-1.014777820189,-1.901733165189,-0.022093021496,-0.465217384514,2.244839365767,-1.555553704274 &
            ,-3.180434999692,-1.715737781893,-0.801890543818,-6.121602634208,1.881621057445,-0.383628722451,2.718838413387,-2.379950422443,0.565335953575,0.994886907507,0.812955315046,-4.152781884445 &
            ,1.523427505501,0.573457591375,-0.465788314100,-1.600434734053,-0.669077335031,0.765078361563,-0.418893832543,-2.363823787455,1.260678818597,0.648285468039,0.459781705508,-0.105033923080 &
            ,-1.504460135395,0.775351860981,-1.985439258512,-0.640449543950,2.264138981600,1.021460568705,0.701146644208,0.008569680281,-2.107736424970,0.414044610063,-3.165063332516,-0.477246339852 &
            ,2.703082044318,1.953087657331,0.627236779466,0.633702326245,-2.198875390283,-1.484342105770,-3.671309390113,-0.683658643865,3.208352259401,1.938326881744,3.514803797182,1.108164623139 &
            ,-1.050808173846,-2.016507954549,-3.141644018232,-2.161698238738,2.249146708862,1.640490135197,3.518313077625,2.745405199441,0.414673297853,-0.521456917885,-0.012495000652,-1.923450316082 &
            ,2.975911929576,-0.139104419758,2.986800570852,1.460410312263,1.307760950417,0.388770931516,0.547345679708,1.364177506291,-1.030939942527,0.102740089708,-1.300833099875,1.019658704172 &
            ,-0.948439327005,0.428982769821,2.101161259493,1.846918724824,-2.978286590491,-1.168574414114,0.933542493405,1.542879322114,2.652951433658,-2.019293136847,-0.323276668156,0.589536487083 &
            ,-4.477174666305,-0.448697108273,4.994581850265,0.578915964691,0.506408111944,-0.281494070498,-0.222939170766,0.066086944187,0.868223733741,-0.034122781912,-2.480403881479,-3.918600162478 &
            ,-1.368165652698,-0.649749874647,2.287877391773,-1.460180969152,-1.246051723914,-1.804413632467,-0.602863022885,-3.099395928630,-1.221315437956,-0.312936673352,-1.332548951113,1.998303684046 &
            ,-1.240521791069,-0.063773829671,0.057024327969,-2.864229612141,-1.529272514293,0.250855270888,-1.223270812170,0.975534083101,-1.567976311338,0.325372074830,3.271305026019,-1.693388469857 &
            ,2.548485955872,0.416309963833,0.054966012909,-1.488161599164,-2.244906316054,0.208356823745,3.399809461933,-5.937247049402,-1.915803045358,-0.599125927448,0.900668447674,-7.879256632195 &
            ,1.645891816455,-0.619053062214,-1.150608822798,-14.184630739738,-1.632356787852,0.187866709039,-1.377162817779,-1.494838345515,8.585555378904,1.091791122402,-0.042414243017,-7.120314015611 &
            ,1.057803842100,0.531719944139,0.772200647261,0.837841589180,3.718105141724,-0.602420626723,-0.447350570273,-3.504480320770,-0.648906109228,-0.216670865434,-0.067114132313,-0.035860692772 &
            ,0.743072762030,-0.268138847577,-0.447337040832,-0.096027004134,0.029508783626,-0.347288815525,0.075496031771,0.543417333708,0.298214218551,-0.308266413596,0.150548635067,0.517677221836 &
            ,-0.335478468579,-0.558139452858,0.170380626051,0.024156511834,0.887139141075,-0.336503885580,-0.349511068865,0.218048923659,-1.782228474064,-0.003708990013,-0.774573028920,-0.837144327058 &
            ,1.366628504212,0.682180762743,-0.717449096417,-0.654063735572,-0.773176746939,0.582967878799,-0.117415438162,-1.121000891947,0.336587978272,0.260113379384,-0.334258812178,-0.961526619723 &
            ,-2.647353996573,0.322036106227,-0.472669630437,-1.250159794670,1.074902699788,0.017853251258,-1.155239404399,-1.027475879085,-1.052333451732,0.196472464229,-0.016983430649,-0.022809419988 &
            ,1.245715732669,-0.271587697188,-1.573082878924,-0.554580908357,-1.677755534024,0.487946178436,0.139908622408,1.421684024942,0.265938686590,-0.764513486048,-2.049668366734,-0.725701574749 &
            ,0.472927842948,0.458624984620,0.021117594199,-0.323461163519,-0.010506705986,0.461758152085,0.077725376908,-0.191319893111,0.322696457365,-0.440520352764,0.547266510488,0.223454562966 &
            ,0.232413678114,-0.448862608786,-0.645321577004,-0.013145149517,0.457416810636,0.115732772042,0.074151816463,0.093992113148,-0.159294400163,0.008826338712,0.150866393312,0.186401175145 &
            ,0.145438385667,0.304787687309,-0.107855135560,0.067080040717,-0.066331151295,0.406651069402,0.259734999055,0.320961711688,0.249091011842,-0.573669757408,0.456001987141,-0.829941120219 &
            ,0.236001100615,-0.392542234059,0.000286941053,0.215158995866,-0.035230322689,0.627262946952,-0.306047918258,0.519194704443,0.459645243255,0.257105659338,-0.657726212026,-0.082286336048 &
            ,-0.280878589596,0.210763746275,-0.047784930662,0.400108556618,0.077766417692,0.069889663893,-0.488823931457,0.280408584739,1.110974801536,-0.992602575675,1.007972418570,-0.598407160424 &
            ,-0.473852507072,-0.458904170292,0.062670281973,0.737557473069,0.509948767542,0.645930469475,0.458874859153,0.137430061417,-1.351722345566,0.124991242775,-0.257716569531,0.011211166255 &
            ,0.996291506890,-0.428080051152,0.599207588700,-0.229063032908,-1.582430210475,0.362211167530,1.171496106612,0.825683175435,0.171169866650,-0.128943751256,0.284367685775,-0.156954448929 &
            ,-0.238201813503,-0.098277964903,0.281779605499,0.243033892909,0.154575125747,-0.072982777046,0.310523329781,-0.126700773149,-0.151407337951,-0.122824269614,0.004934242229,0.043369279891 &
            ,0.257966771831,-0.134839987918,0.230763688854,-0.046791255885,-0.119596822310,0.100580332226,0.057295858653,0.057488918738,0.189040432216,0.050797156260,0.248730014404,-0.058495891754 &
            ,-0.047684648497,0.088745045837,-0.063686726222,0.003925211244,0.379880097319,-0.312090916921,0.609313474386,-0.022328213418,-0.294209232558,-0.281095530339,0.039949961107,0.232931641460 &
            ,0.547587466649,0.232664817338,0.483776825054,-0.005137318042,-0.189395475365,0.154875485653,-0.086830569105,0.000170162086,0.271813863947,0.780160383225,0.228192468887,-0.056868223213 &
            ,-0.236156896843,0.454059855816,0.157798480344,0.058134423474,-0.012975819558,-0.183181148383,0.186342145775,-0.227500198353,-0.018873109782,0.086075015673,-0.003417065141,0.002153300011 &
            ,-0.133338662812,0.105630999332,0.022970934971,0.122181242376,-0.012230905854,-0.048147866567,-0.107722518693,0.006917662378,0.086110190669,0.186810123310,-0.007802830426,-0.127001018923 &
            ,-0.058976907255,0.029042362184,0.091026186822,-0.035965967327,-0.015807214999,-0.156869768050,-0.034667891164,-0.006834308747,-0.041242876236,0.029791273083,0.072396615162,0.017999453941 &
            ,0.104888948260,-0.034615226048,0.014204836150,-0.008941944412,-0.028012477618,-0.001823214812,0.104147821781,0.062440252071,0.091081762111,-0.083776467989,0.027876324700,0.033656097568 &
            ,-0.028180570797,0.019394345507,0.080933974930,0.067409870879,0.074583679456,0.059264257869,-0.026307548357,0.212517016554,-0.068197564275,0.023948703541,-0.025164821919,-0.005747776026 &
            ,-0.067101743853,0.046527018131,-0.006392975254,-0.059445304967,-0.016727795233,0.006242941336,0.079108185975,0.030620551093,-0.025386723964,0.208648411302,-0.037434384567,0.424231800942 &
            ,-0.063250388789,-0.029952154042,0.031578648191,0.168569563007,-0.115175399361,0.091974307915,-0.089627018257,0.261022628977,0.078136356684,0.017944699871,0.118340718446,0.204114956380 &
            ,0.007332761405,-0.036581163392,-0.099656100909,-0.025934681603,0.315211346267,0.074900528337,0.028524712399,-0.001507961546,-0.014012406221,-0.027406760170,0.009997621678,-0.000325941378 &
            ,0.090943644200,-0.013179342607,-0.068960582743,-0.020104570325,0.000904499048,0.004069387514,-0.008345520916,0.019456665194,0.056361042561,0.011036068849,-0.017398011693,0.008570826652 &
            ,0.020082698806,0.000303731607,0.019909941922,0.013427957405,0.030112710648,-0.005016676086,-0.005151704717,0.016918180817,-0.001739321486,0.012636306788,-0.016642472546,0.001284836938 &
            ,0.031945739964,0.002942245375,-0.007432185208,-0.007426117481,0.000344724015,0.013029214046,-0.008493675181,0.020760493826,0.025275396901,0.003021609650,-0.012160619876,0.001330840929 &
            ,0.010996169241,-0.070146162473,-0.039367611862,0.107732615435,0.031853342887,0.017797985008,-0.058007119616,-0.020359464697,-0.025828633441,-0.019252940801,-0.011062543338,0.047188088855 &
            ,0.014575912460,0.000681138994,-0.022234722435,0.006844103525,-0.033501823773,0.041585079528,0.059020407741,-0.021227535827,0.046633198298,-0.033577630210,-0.136683674039,-0.067972404222 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-6.5166,-1.66 &
            ,2.866,-8.6306,7.0686,18.0336 &
            ,5.7104,0.99609 &
            ,8.7614,-2.194 &
            ,-3.1012,14.8267 &
            ,11.1331,-0.8481 &
            ,-14.0569,-0.84744 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-5.1593,-0.76147/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.6688,-1.0418,-5.3874,9.0407,-0.9893,3.8465,-4.1588,-0.54442/)
real, dimension(2) :: bias2 = &
  (/-5.535,-1.9/)
real, dimension(1) :: bias3 = &
  (/6.0458/)
contains
subroutine fnet_LosVaqueros_initall()
end subroutine fnet_LosVaqueros_initall
subroutine fnet_LosVaqueros_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_LosVaqueros_engine
end module fnet_LosVaqueros
