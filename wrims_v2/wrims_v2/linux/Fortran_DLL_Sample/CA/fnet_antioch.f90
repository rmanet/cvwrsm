module fnet_antioch

! a = 8.7278e-005
! b = 0.084558

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.617681280145,-0.090318265956,-0.985716028204,0.632606856366,0.186759325965,0.324800012591,1.122129416284,0.177984070934,0.017501330819,0.210104123632,2.438727205440,-0.516319520972 &
            ,-1.033575254187,-1.382343750884,-0.648712487070,0.035245590813,0.227964657587,0.082324753003,-0.499841781520,-0.370725295449,0.736720800427,2.952561687704,-0.834436040486,-1.013058762621 &
            ,-1.418531350866,0.701658390548,-3.190136317733,-0.122403830608,0.086658460244,-1.613963453420,0.108850948987,-0.936878026330,-2.277246101526,-0.747307823689,6.862268131042,-0.301430299011 &
            ,-2.640231860182,3.580868540405,-1.247038098932,-2.667318849415,4.178623563636,0.978320195392,-5.878587779850,0.060729677277,3.672628794037,-1.359509699660,1.511459308009,3.990043582021 &
            ,-0.596895477194,0.146824621883,0.493631408310,0.154728646568,-0.382570012310,-2.024996589759,-0.726908095213,-0.828919340671,-1.878642507374,-0.741791587729,2.651401705487,0.235346228765 &
            ,-0.804554513838,4.262091246753,-0.004195471992,-1.070718538157,-1.168995069205,-0.668303282662,-1.563791921164,0.157838336368,0.306206371461,1.136775440609,-0.484791850200,0.105372990186 &
            ,-1.867674944520,0.393291505339,0.514030424037,0.590261678315,-2.866668665293,-7.255196718767,1.642768200544,-0.280829710345,0.088873950530,-0.178068836346,-0.424944826088,-0.014961714700 &
            ,0.722012998772,1.565331393968,-0.221327000631,0.325929228912,1.940841145876,-1.107195857303,-0.023946375489,0.297268133724,1.186288726360,1.114952204763,-0.554441973312,1.526317394342 &
            ,1.279680078845,0.353612674857,0.045384153902,-0.181847772936,0.173718630462,0.603221886364,0.684785915288,0.406560888099,-0.698995574832,-0.145821146823,-0.034547487379,0.273187078972 &
            ,-0.043587468562,1.019256918933,0.445220101523,-0.134362583893,0.629101819688,0.063571090265,-0.555182113451,0.100738264062,0.126968383309,-0.200471430544,0.513303462114,0.099051968683 &
            ,-0.170831462178,-0.982288102120,1.262552830304,0.619973343134,-0.620520287912,1.368392356958,0.404496635155,-0.261697602011,0.767050027444,0.809969085174,0.055060125739,-0.738324117704 &
            ,0.967920657248,0.807162356547,-0.823942176903,-0.133562199261,0.711269175370,0.418423076918,0.422897995724,-0.728969796737,0.570709895010,1.605757736971,-1.229268883315,-0.623784854432 &
            ,-1.056085352510,0.280830860129,0.565207487074,-0.276941317100,-1.298575101221,-3.655301255552,0.613215245097,0.730247520460,2.509817952455,-1.098937304347,0.927969444470,0.284550139009 &
            ,0.586929376779,2.523791096966,-0.422379788412,0.430847997256,-1.456933533848,0.876252721957,3.198434993565,-0.170937360549,-0.716654045949,-0.045595617039,0.384499571233,-0.202432824543 &
            ,1.155340812687,-0.956127638055,-3.072272963630,0.486634772782,1.345004749849,0.593513731633,-0.320355346163,1.177973266141,0.904169097223,-0.156668273213,-2.036100926309,0.564142893394 &
            ,0.923346695678,1.173760645614,0.366113003620,-1.624635492977,-5.777831482305,-1.465351913408,-0.382660611014,1.286902456484,-2.360775007590,-2.767688026350,-0.251817958895,-1.929178194867 &
            ,1.040574927846,-0.092739424522,-0.452542493222,-0.370528522887,0.172601902221,0.006992284449,0.108322784072,0.579287877155,2.565432552989,0.076265186978,3.383581285928,-0.382057111391 &
            ,-0.298404372638,-4.472363648864,-0.230224230048,2.467028491603,-2.208208696573,0.108139960634,-2.732718228284,1.103483365722,0.110742510148,-2.561994833430,3.218771741761,2.469581611181 &
            ,2.478445558169,-0.994768105421,2.116996618411,-0.533807901514,-0.403184740053,1.582052268241,-0.468056011888,-0.366198380263,-2.494514887538,0.301364995932,2.326246090849,-0.495972342349 &
            ,-1.563575171746,-1.113830781767,-0.111352982924,-0.803624630596,-1.231005839247,-0.282257321833,0.480079106828,0.264009063768,-0.571458847242,0.447392874379,0.450485622097,-0.621257357358 &
            ,0.056381340058,-0.644679285658,0.465410180509,0.235571639003,-0.031077241722,0.182661395816,-0.196445558822,0.045651072685,-0.237679308235,0.202779165365,1.044488907743,-0.437934102643 &
            ,-0.610557808948,-0.488255049651,-0.351279985220,-0.122174211013,1.032011915535,-0.059618413453,-0.973340528242,-0.148922075844,0.563263431471,0.327552060519,0.137842278488,0.573995448764 &
            ,0.843447943028,-0.079125449842,-2.120873680829,-0.154387892919,0.805589178307,0.392909245177,-0.077429432434,0.339385311879,0.919698666821,-0.795507501817,-1.180796639878,-0.051026425331 &
            ,0.675662890862,0.974464104540,-0.723569956383,0.373521066958,0.899749298182,0.282250582724,-0.712835144423,-0.258901155178,0.834708965283,-0.854578474521,-0.894017303875,0.387985215434 &
            ,-0.833231237965,-0.418977871356,-1.466002026253,0.230555658276,0.441935172045,1.401052205147,0.017310327331,1.021029552752,0.050666659840,-0.034031720104,-0.125570109448,1.141639859341 &
            ,-0.574197710315,-2.591081112235,1.136071470352,0.433286292089,-1.944751309151,0.156337974268,-0.813214384510,0.027851205731,-1.142411295068,0.973406250979,1.274403847319,-0.532711417102 &
            ,0.839359789429,1.172698056683,0.241309696056,-1.174062916248,0.747215769985,1.235726601326,-0.436641284834,-0.142281556838,0.817593680402,0.278884365323,2.728208390163,-0.287826188184 &
            ,-1.692059225078,-1.976466970094,0.766960910454,0.013463262585,0.928981525052,1.569970719933,3.666320524338,-1.323149289218,-0.390676033563,0.403323576305,-1.130946483294,-1.809337600508 &
            ,0.883236300080,-0.178553605197,1.978307299406,-0.244814547675,-0.275727015878,2.678872813148,0.473804728363,0.537308907905,0.377225101311,-0.910974828313,3.964228007185,0.316990039540 &
            ,-1.037383516862,0.251917112680,-0.304626964086,-0.627634537460,-5.089484375042,-1.289886366563,-1.783711446265,1.906912386407,-1.987448186019,-0.174517296319,2.387031833824,-0.344039322775 &
            ,-5.714537451147,-0.308163576078,-2.875989760524,0.588814051873,0.609229598219,5.281759072147,0.146396783299,-1.427014177201,-0.358954726953,0.454703927005,-0.396193948907,-0.005508568029 &
            ,-0.121448783687,-0.665130593889,0.237391798658,-0.234203611445,-1.036251790998,-0.158515519795,-0.798532570874,0.257967261680,0.167265309563,1.237663349514,0.384204738021,0.008872552508 &
            ,-0.588183807353,0.138296567337,0.232673426267,-0.015834066356,-0.359708403089,-0.906237905005,-0.056966422677,-0.136791162761,-0.024315473012,-0.035288674774,-0.331789161745,0.095643540574 &
            ,0.065305217427,-0.733910559133,0.084646357702,0.356151373664,-1.423721995115,-0.301462768359,-0.000672985271,0.354245584287,-0.769779833180,-0.584144460418,0.225047938429,-0.419621732895 &
            ,-1.129338736994,-0.332174615292,0.328870030168,0.324071399227,-0.516742215502,1.258309182407,0.485850056095,-0.617246380385,-0.554370221292,0.285592567576,-0.818727408541,-0.224248761220 &
            ,0.255050397359,0.263421980487,-0.295990247061,-0.453543747393,-0.120362602145,-0.463542890029,0.632972548660,-0.004575001150,-0.630983464031,-2.331971250499,-0.167505828032,0.692044614812 &
            ,-6.172724486522,1.548725148431,4.044082960419,0.307305670088,-4.100579602467,-2.454888423967,6.343677305799,6.615237609732,-1.524517532562,-1.081151231413,0.019017056640,0.808793323932 &
            ,-0.610080076093,-2.781127916791,-1.138330792231,-2.184159290397,-1.243862724431,1.239728519306,0.496434392373,-1.847193677478,-0.133647583335,5.257463951960,-4.811243733087,-8.911746042885 &
            ,-1.431211726757,-3.296489089849,-6.226056906063,2.472854785669,1.560530848270,7.982233112550,0.579180893844,-2.439011900073,2.535981001511,3.632422308951,4.979957900549,-3.021811558650 &
            ,-0.022737218201,1.772098112101,-3.270995348616,1.617333601928,1.339802225178,1.566951857736,3.756472607042,-1.173314877923,-1.983295111423,-4.376463268219,-1.389963263182,0.207437130082 &
            ,-0.537379509580,0.670727722132,-1.110995252592,-0.447766942028,3.363913709663,-1.763350228878,-3.068435328487,1.441072790571,-0.000894008596,-0.792785979100,-2.500032617678,2.570405335104 &
            ,-0.391899536581,-4.876998576442,4.045851062357,2.556731696122,-5.319472022813,-1.261530142837,-4.181708674066,3.071968947717,-3.079834850929,-3.630247815011,5.064154514965,4.547622024993 &
            ,0.999974808054,4.088303093511,-2.434168380747,1.889727747831,-3.053753210565,0.884370374642,3.545088725600,-1.043783491897,0.378601354125,0.618550744582,3.010851018002,1.236925094839 &
            ,3.739512124374,-0.071945557542,3.248138733460,3.371326498747,1.830718603550,0.801455078732,0.311197346622,0.176540387998,0.434313955116,0.989546232318,0.889783610496,3.689137826891 &
            ,3.022827119812,0.803062711924,-0.346453617446,-0.484482743393,1.506745753545,0.557091958333,1.405269881820,3.011942677047,3.764841802139,1.382929438279,-1.595203407548,0.059628253535 &
            ,2.275373640883,0.204308465563,1.036470886397,2.941617929689,4.122714834778,2.123611338598,-4.103021615110,0.732075230557,1.791465663730,0.433214580430,-0.158174207388,2.759294886462 &
            ,3.651043115003,0.961458785823,-3.971575291745,-1.086501157235,4.389764757272,0.851800157577,0.682008249967,2.057851606913,3.746584250733,1.206081308989,-3.434686314477,1.619771503293 &
            ,5.064545752857,3.483724399694,0.023028822077,1.941269729900,5.337016655469,-4.488748509584,-5.103937283154,1.022300611416,2.014224541672,7.994553420993,0.878120801163,-0.531929434438 &
            ,2.077197408918,-0.881418097171,7.312988965628,0.326020321314,-2.149537920143,-4.611757800349,2.175421881181,3.465921105799,2.666377059520,0.937876013432,-3.939056140100,-1.007505276769 &
            ,0.918448498395,-2.291573589888,-2.337258708948,0.877110460732,0.371721977452,-0.999130543275,0.608443210789,0.681395888880,-3.369410914317,-5.988186913858,1.601370734624,1.676728693962 &
            ,0.592713413153,-3.405153563694,-0.722667517171,1.059944645646,2.048782384455,-1.406706734419,-3.765089041404,4.112097243312,-1.708906171570,2.051694866455,-2.208939662661,-1.220222689438 &
            ,-3.933855805926,-6.309714282944,-1.259284438048,3.415751532721,4.379573277601,0.211991218278,0.783912599597,0.237511537841,-1.086134765876,1.752747079826,-1.405691361628,-3.041831138126 &
            ,-1.309121657413,3.777796462364,0.384748074661,-1.048362234245,3.122137449231,-2.776361397329,-3.137745132116,5.734275826936,-3.501950974551,2.639828946952,3.919576437124,-1.025901577043 &
            ,-4.752533803550,0.896437857454,-3.774995877577,0.630695337061,3.876386542541,12.608788945707,3.710147742330,0.575233024110,-2.164801512769,-4.264825008872,6.527783230368,-1.124518253044 &
            ,1.088102115623,9.681409517852,0.745529013441,7.650103909709,-1.164108480210,5.345891192029,2.045130595181,-3.528581750996,-0.696468375194,1.925382427653,0.884437117301,3.860727026906 &
            ,0.050543734390,0.780010974453,3.074737415656,-0.427898138921,-1.192428112379,1.704178528560,-1.328508747823,2.843556894902,0.326732307920,-0.419477524307,2.856734980356,1.258465324316 &
            ,0.991668962177,1.490844862729,0.091914581342,2.588374791454,0.088563625514,-2.512135397900,2.330139065809,0.393578267530,3.469690734075,-1.013805542796,0.824267463311,2.244643669225 &
            ,-0.232723579755,-2.269182861300,0.225929931289,2.214494576103,3.666861891592,0.647614781235,0.972289028423,2.194600203861,1.495533028389,0.050648383893,-0.879762935558,0.434815908509 &
            ,1.986692384704,1.928307060294,0.461873803692,0.718267098670,1.225620590001,2.184128146431,-0.726495287499,-0.351188356215,1.520432365235,-0.017821233825,-1.602341311746,2.249987735300 &
            ,1.854308000509,2.770964123656,1.379727249052,1.369570548926,3.253918590509,-1.169020320269,-0.373334779032,0.545433025324,0.582195150495,3.983229055007,0.333534533373,-0.398062903036 &
            ,-0.275169972351,0.146630521126,-0.583019083145,-0.099459318299,0.118643486503,0.183177794560,-0.279394361635,-0.524244802715,1.232093879783,0.116696405332,0.373823834899,-0.051676237809 &
            ,0.448686186998,0.229950540353,0.129846084101,0.515253496943,-0.035082848479,-0.659980792202,-0.402371065901,0.387325018735,-0.019566644573,0.674382982113,0.152928007080,-0.253289680301 &
            ,-1.443129599751,0.076275203388,0.931467047341,0.024489495912,-0.760110950009,0.915398561764,0.247811782497,-1.090788592918,-0.241360461721,0.538407281866,-0.797824764874,-0.174809924856 &
            ,0.479798242250,-1.647621672563,0.211409067435,0.940237751840,2.121068410429,-0.717623055572,-0.252377620653,0.227347348698,0.791629210166,1.106931017807,-0.091955110384,0.274469732924 &
            ,-0.289955371345,0.152786487479,0.072299626146,-0.093269004186,-0.341459089106,-0.326427609005,0.278225383619,-0.424669181586,-0.949399185621,-0.378581505739,0.483672393917,0.027048242624 &
            ,-0.581746494423,-0.591442991700,0.137037017734,-0.444212659117,1.822902944516,-1.276790887036,-0.276833732060,0.169330921081,0.904966064310,1.111517625414,-0.241588394809,1.062280051450 &
            ,-1.482528239121,-1.198493310097,-0.101368041113,-0.205258643233,-0.817487088864,-1.749507264396,-0.458426093574,-0.280088074874,0.041830138477,-0.182872609235,-0.142479042627,-0.156740782942 &
            ,0.067775009014,0.240742745196,0.003912157011,0.213540299727,-0.122632717330,-0.011440803124,0.045151121063,-0.243696105618,0.217719062393,0.529101255781,-0.335797177961,0.001310299014 &
            ,-0.017616891886,-0.027010529732,0.078391056084,-0.201101673572,-0.147136989992,-0.099568158061,-0.121651489255,-0.320846075213,-0.622311253920,-0.070461396073,0.155501614692,-0.169650147422 &
            ,-0.131284696653,0.704331842783,-0.238177822336,-0.558316111087,-0.379373397590,-0.161695204001,0.124045726940,-0.070184037807,-0.239835637192,-0.111671182688,0.036678379681,-0.137134611371 &
            ,-0.473432461080,-0.458183132995,0.369191257810,0.103375716275,-0.166091446942,0.447881121747,0.033205204415,0.091928318915,-0.355210956994,-0.174852957794,-0.026837922727,-0.048261508731 &
            ,-0.148221102551,-0.206955616900,-0.039074012060,-0.018792288344,-0.218000587045,0.028687795226,-0.224496787518,0.035782670142,-0.106328746223,-0.811636674822,-0.104056997548,-0.095777788815 &
            ,-0.192575633622,0.011477338457,0.261269204235,0.056091750004,-0.192705586955,0.147890603684,0.160194347190,-0.257744589773,-0.351595447852,-0.109943196924,-0.080377913248,0.112044290553 &
            ,-0.161441277276,0.001035422706,0.105780315217,-0.156861716374,0.678518556629,0.011895879409,0.098417538334,-0.146771035294,0.246840390147,0.216782273761,-0.264075945509,0.127392104363 &
            ,0.064784997671,0.071904879087,-0.236669182677,0.014528264258,0.153197723062,-0.392796448412,0.051366090335,0.350920315745,-0.176378322710,-0.010276482171,-0.018554173323,0.016023971704 &
            ,-0.051062238787,0.221470012717,0.047256023337,-0.166897029824,0.133706106709,-0.075904942919,-0.008633757035,0.022141468424,0.024192476223,-0.069370378854,-0.000105658080,0.156060788868 &
            ,-0.184992585601,0.023845650809,0.020135117612,0.012820432252,-0.111913278954,-0.118730067412,0.012994559394,-0.188331688142,0.468924069257,-0.086463385198,-0.084752971737,0.065287069314 &
            ,0.171816093334,0.389512914522,0.165710398673,0.185805447147,-0.416407168282,0.130893853405,0.244528234126,-0.067802008270,-0.207041289813,-0.262479677201,-0.001349918688,-0.136287859383 &
            ,0.056334342389,0.100646654125,-0.089806036077,-0.013073480038,0.103708211952,0.324964756501,0.057051766043,-0.087354984848,0.107363930602,-0.062765893481,0.061134642485,0.027909345264 &
            ,-0.008323151632,-0.014794095287,0.043565723935,0.091780592561,0.054738819113,0.017273519484,0.004316300443,-0.002149044106,-0.026708675056,-0.063556970613,0.048434916576,-0.017006614683 &
            ,0.048619697640,0.011892661062,-0.006322707322,0.007147498319,-0.010855823775,-0.031834042783,0.037818501274,-0.025076898968,0.017150834045,0.023835354988,0.060201270079,0.017077811937 &
            ,-0.037105371034,0.012782219895,0.096727464454,-0.005911322241,0.037946075827,0.014688365899,-0.133680852421,-0.004491770484,0.044501840180,-0.060359973664,0.004670991571,0.037534668314 &
            ,0.134524848351,0.080935923031,-0.023207762777,-0.038510851929,0.085568918036,-0.050838762728,-0.004067178352,0.094135982947,-0.009296374704,-0.039814953011,0.008411354141,-0.009193169384 &
            ,0.005725795195,-0.020390104593,-0.077992779879,0.054487577934,0.160012564077,-0.068574852354,-0.051538154616,0.074748014022,0.003375370780,-0.111738872091,0.124862021761,0.130990893947 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.4355,4.2009 &
            ,4.7283,9.705,2.257,-13.0289 &
            ,8.9094,4.9513 &
            ,1.5152,-18.7618 &
            ,0.0084564,5.528 &
            ,-2.8438,-10.2832 &
            ,-0.7622,18.1696 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.91203,-1.3898/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.4943,-0.32355,-0.24164,-5.3878,3.3145,-0.73409,-4.0791,-2.3716/)
real, dimension(2) :: bias2 = &
  (/-4.5984,3.9134/)
real, dimension(1) :: bias3 = &
  (/2.4069/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
