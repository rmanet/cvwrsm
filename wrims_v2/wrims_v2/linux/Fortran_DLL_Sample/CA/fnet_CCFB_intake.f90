module fnet_CCFB_intake

! a = 0.00078109
! b = -0.023919

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.147024301684,-0.186990240243,-0.282709040828,-0.069699292656,-1.115097059099,1.757722951745,0.445627208429,-0.495648419576,-0.043931618571,0.058015335933,-0.086187109351,0.165911933090 &
            ,-0.650692216581,1.268388441269,-0.194077703665,-0.114265370452,0.173799696977,0.389988292878,0.092681486334,-0.403204427083,0.507789009378,-0.895900729979,0.306400323640,0.446860575381 &
            ,-0.083672906700,0.131975522862,-0.200781050479,0.038854178259,1.010409978932,-1.081188718666,0.063421678330,-0.553397996982,0.092611510200,-0.191620136861,0.285055529572,-0.085456589117 &
            ,-0.585560602800,1.317906906536,-0.041785843208,0.006566144452,0.080582572842,-0.097372985544,-0.175593475433,0.141030171013,-0.779609423435,1.092550882193,-0.025390462258,-0.123291496026 &
            ,-0.164947311532,0.330607406471,-0.504980460834,-0.147848178275,0.614129107568,-1.088670734324,0.327544715813,-0.952027583205,0.029833027531,-0.208336266944,0.354162095429,0.011279412122 &
            ,-0.262895924690,0.656989888205,-0.293889444749,0.200221680015,-0.007846248544,1.005867057374,-0.398600080734,0.167979959289,-0.306380419398,1.124769928263,-0.394985547645,0.300640673076 &
            ,0.024617960459,1.786696269409,-1.148210026287,0.644915410833,-4.353025278774,5.819828184204,-0.864505409393,2.038087444685,0.225534052301,-0.043649090808,-0.055246087297,-0.027858139534 &
            ,-0.298338790422,0.331031387157,0.112548821775,-0.131109802610,0.116643409957,0.126327023529,0.002092572192,0.040519447259,-0.158607719136,0.100640711714,-0.122384686577,0.120440508433 &
            ,0.506934828467,0.313188221966,0.041953699550,0.043099946050,-0.176933994249,0.326726342571,-0.224412611022,0.247195330049,0.351075676963,0.461871756672,-0.208219978074,-0.106941523889 &
            ,0.040739669243,0.035276290678,0.200856991624,-0.061757149204,0.467004384189,-0.347894385120,0.211704676760,-0.038322515806,0.481573781020,-0.732135296049,0.127355691368,-0.280234957543 &
            ,1.054429900485,-0.264871691212,0.176530130537,-0.164621214162,2.028056829498,-2.853295651463,0.368788980369,-0.757398571990,0.218947102866,-0.289848636146,0.269384357080,0.232499134345 &
            ,0.326077489603,-0.491255300627,-0.372044695283,0.141247075378,-0.133844271045,0.170674116975,-0.414503911842,-0.230600517849,-0.043986712891,-0.035428462356,0.520398062660,-0.637438412468 &
            ,-0.075364471901,0.546392861276,-0.324936381747,0.521672297475,-0.830538721111,1.027832670940,-0.710666502930,1.034615788095,-0.128774351794,1.194660057137,-0.584563432263,0.366947485411 &
            ,-0.342338773730,0.378681215917,-0.595769502242,1.035164915117,-0.182587828991,0.359463476787,-0.501756743945,0.132208674824,-0.034503080386,1.060143950060,0.085488822565,-0.843440878773 &
            ,-0.165413026165,0.568995213646,-0.918566892331,0.769599148678,-1.622031042874,2.366001035516,-0.557610409248,-0.141682435316,-0.031208943916,-0.543924647252,0.256926398102,0.054044207135 &
            ,0.687804499430,-0.357374020166,-0.049335440269,-0.924721167552,-0.171097825187,-0.043216183101,-0.470012824689,0.199008030173,-0.770081545284,1.289801828252,0.240056146403,-0.597940473002 &
            ,0.079435656105,0.160637557469,-0.026306506977,0.392228316592,-0.948078295459,0.541961208711,-0.525035715143,1.098629828028,0.006902209071,-0.810944167902,0.041759472876,0.526152462011 &
            ,0.262426354182,0.001241889309,-0.258167558538,-1.231812589884,0.094377207147,-0.258380163289,0.350239628714,0.408240781602,0.833753998510,-1.123069629237,-0.700859271120,0.303629150059 &
            ,0.089137785570,-0.658149832929,0.465805234420,0.841371055733,0.580048481102,-1.154412031919,-1.149183558980,0.635093667021,0.008201710364,0.058145839400,-0.063550472147,0.056608024699 &
            ,-0.363040816004,0.392393158586,-0.036676564007,0.225962777941,-0.017242743444,0.147246661289,-0.131501987229,0.161659329269,-0.455914953722,0.527492308134,-0.186741014980,0.284215093233 &
            ,-0.046427021997,0.039903339141,-0.038335379015,0.065241287365,-0.394375402372,0.090821960076,-0.101001387511,0.394789520477,-0.029250627974,0.098936624061,-0.102767405313,0.087216361598 &
            ,0.080061692157,0.092762505996,-0.065699557068,-0.036956063656,0.099584270057,-0.279704369844,0.249218504672,-0.215718145485,0.417332449531,-0.273208974370,0.261961802234,-0.320784925126 &
            ,-0.187255834790,0.347535517441,-0.253569588899,0.386455903447,-0.735065924400,0.587237324296,-0.513015649466,0.858728273787,-0.117712334096,0.083416709994,-0.215241381689,0.292466568756 &
            ,-1.031022628216,0.986911123275,-0.278417343456,0.518781148866,-0.109751136892,0.661996556994,-0.307559518951,-0.114908743185,-0.572724649660,0.902180590263,0.053992023090,0.366797367176 &
            ,-0.119682577567,1.230090170717,-1.006825920312,-0.064841921472,0.431474369711,0.298663616775,0.295785021514,-0.722990834732,-0.124949449703,-0.853574702012,0.024874368492,-0.058003911184 &
            ,-0.321246623456,0.684915730897,0.453585181873,-1.309804923920,-0.322014120840,0.944786084091,-0.890169139555,-0.202511642514,0.163090240764,0.222686840994,0.517130326556,-0.663095243816 &
            ,0.058623042666,-0.931163723639,0.403893941976,-0.412462031165,0.078840301199,-0.398730551559,0.642245755245,-0.761043268342,0.029204986017,-1.140871146540,1.023758531487,-0.147364309194 &
            ,0.626435207918,-1.148717096534,-0.202280743304,0.139369988124,0.381158752116,-2.111595629884,1.686935943788,-0.404026741616,0.759372334059,-2.033965963228,0.144088649940,0.133040694549 &
            ,0.357839565925,-0.687137974432,0.867553084938,-0.292710636399,1.710922996464,-2.077028450093,0.016917847983,-0.251644618525,0.491996665582,-2.766027858581,1.723468868491,0.069647439072 &
            ,0.853593642708,-1.333461573066,-0.123848518001,-0.953777738425,-0.172770919233,1.162277379204,-0.977279561667,0.389117450410,0.237601783036,0.385367222453,-0.247265672798,-0.545779648328 &
            ,-0.093693956042,1.598438033845,-1.482913496433,0.075447331948,-0.130873535398,0.770640434657,0.423355368057,-0.960154709688,-0.058505344570,0.210198868994,-0.122283654400,-0.028464014364 &
            ,-0.091232857588,0.023279658304,0.025148867969,0.102235767856,-0.028570036840,0.097091436582,-0.074444961640,-0.068762588521,0.112569762231,0.121504560835,0.119422168353,-0.256156977668 &
            ,-0.002639960634,0.053304845704,-0.085055723634,0.015248054314,-0.172171423679,0.060608616143,0.021325722653,0.033613883608,-0.017561137191,0.218374519243,-0.159932568967,0.061255260524 &
            ,0.044964728963,0.143185317504,-0.045475222612,-0.097341799983,-0.004922352539,0.366179742251,-0.188340175084,-0.018678668059,-0.048816335132,0.265729100758,0.016578659835,0.026072274490 &
            ,-0.059479641462,-0.105307130344,0.007280198680,0.059537929348,-0.043788222028,-0.108905667134,-0.057067298203,0.017774113763,0.007815873567,-0.198327431361,0.102910492457,-0.072557058378 &
            ,-0.104213512525,0.045050388862,0.103756557365,-0.083258978895,0.005093928090,0.153119370986,-0.050085175498,0.114375339190,0.166239875286,0.124211919595,-0.172185892085,-0.052992711815 &
            ,-0.319342867428,1.202104281302,-1.243698931719,-1.059311512078,-1.079092946174,1.073215344784,1.714615645285,-0.439353517777,0.049430745373,0.401924530298,0.381752138211,-2.476088330158 &
            ,-1.056360246238,1.832322594225,3.146255788079,-0.908183950493,0.271661453838,-0.796484648930,0.353706507913,-1.979589641545,0.122971533210,-0.100868757608,2.854388901304,-1.097742200317 &
            ,-0.305758851533,-0.336325673079,-0.982972202201,2.500084474753,0.732225540747,-3.623980668163,-2.653290217169,0.838923507828,0.104958361136,1.504982647454,0.016784017298,-2.617462544204 &
            ,0.123289156499,5.521550474847,2.754552145346,-3.134259732737,0.199844858921,-2.105367022097,0.994779077585,-2.712446168583,-0.405133883566,-0.528810954773,3.864961388848,-0.811231350499 &
            ,-0.287703936221,1.162101069506,-0.596395861749,-1.448699309843,2.786912855244,-6.589024171464,0.812985875001,-1.827055390251,0.343136253711,1.202421239890,1.087300481158,-3.104784610602 &
            ,3.582944099687,-2.803629708600,1.880754654746,-0.881293974851,0.071314432240,1.576464516080,0.421037993904,-2.678450393271,1.239779583794,2.057351610902,1.291909827365,-2.572547101543 &
            ,-0.013999873506,0.602630370154,-0.017500184039,-2.981084066549,-1.682608439670,0.897832978720,2.381551721789,-0.637073100904,0.096381460846,-1.378206798494,-0.163628596277,-0.652424515030 &
            ,2.504558097406,-3.439365949598,2.083444892056,-1.369756082267,0.076086486948,0.009874735069,0.777516039220,-1.737018090002,2.079751897604,-4.327033764440,0.413425584523,-2.863349110949 &
            ,0.321043998595,0.154094218334,-0.007717660565,-0.569463667676,4.696981893053,-3.884112432098,0.632535299003,-3.194862454487,0.113183091063,-0.188095096512,0.054482162437,-0.385822863563 &
            ,6.122292849402,-1.881117854792,1.855453522445,-2.897127481619,0.297265296152,-0.354717211928,0.764206878019,-2.398187387296,1.356610819475,1.209532525152,1.946914696895,-4.582424704402 &
            ,-0.728838632498,-0.528750059448,0.792414159356,-2.235916791843,-1.894303737901,3.145023029021,3.022813235623,-5.333905347721,0.037077770389,0.198640441164,0.109465547188,-2.578390057492 &
            ,-1.993559436906,2.614709746383,2.234208659842,-4.339108797463,-0.217055843024,1.057316209394,-1.760937992389,-0.366891732617,-0.414885030062,2.823497698275,1.799072043167,-1.146917777105 &
            ,0.624348665582,-2.676977470215,2.779818862381,0.558643990918,-0.064181806964,0.306058172053,-1.731380493831,2.368429995308,-0.050049537612,0.901155708290,-0.165710326724,-1.508125183705 &
            ,1.684660294204,-1.889621260410,1.635034396735,-0.911669740282,-0.181310918934,0.241600001501,-0.667825118856,-0.603341262190,-2.965732760427,3.704879419373,0.886632954197,0.625683106420 &
            ,0.003660872086,2.788910947077,-0.195008946521,-2.689597313069,-1.009110471000,2.695946995844,2.179316279858,2.021044181608,-0.048936085659,0.850214846071,0.010681452845,-2.346629581508 &
            ,0.843148433057,0.433344157030,2.184910342318,-1.335386963564,-0.523858814951,2.223388140575,-2.334782040307,-2.839726325255,0.021576402171,-0.026315879473,4.166123467077,-1.759053793974 &
            ,0.049794552588,4.015188162836,-0.445790372701,-6.618700935274,0.933789949608,-2.196902328384,6.288741238420,1.355410939054,-0.288195591313,5.941440905372,-0.925467485091,-9.715407681464 &
            ,2.553423501150,-1.384085611423,8.420614318634,-2.481242230548,0.004428842268,2.838263235600,0.178254146458,-6.502586757093,1.832644595957,-2.387589503328,5.530439606295,0.517400858046 &
            ,-0.298703979884,3.382739034869,-1.349275135178,-5.241649942353,0.527320613504,-0.636805263150,5.732524136536,-0.529553486824,-0.053344351524,0.577477021591,-0.371195374761,-0.896866094844 &
            ,-0.105032310912,0.313088982639,1.194707869451,-0.870516665808,-0.085487084677,-0.072070136094,-0.261584809804,-0.541391533283,-0.325259437612,1.074240375896,0.907849645339,-1.100274332624 &
            ,-0.167664527964,0.562625099511,-0.278334375088,-0.475926174640,-0.217728002412,0.155076666642,0.576452605554,-0.136700299128,-0.067383098272,0.094055201927,-0.218114822770,-0.248393218670 &
            ,-0.304825639960,0.183901537752,0.407652167421,-0.230024852985,-0.052173584471,0.477420683808,-0.277949566277,0.241022991203,0.164594881620,-0.803274469296,-0.340761668140,0.745511336475 &
            ,0.092238955108,0.751091598933,0.211465686674,-0.169226960574,1.662961561308,-0.745659557311,-0.384131510914,-0.762084825253,0.226441413425,-0.740394195833,0.669153735073,0.430187945968 &
            ,0.251507315871,-0.733233841550,-0.680984917447,1.073970149638,0.175276599549,-0.793496636229,0.754860461422,-0.291669224166,-0.151642092655,0.244265371215,0.222524339763,0.471920579007 &
            ,0.008885528395,0.479913958854,-0.215887582356,0.243233105889,0.083218674227,-0.128405966111,-0.385347676175,0.421512961567,0.139963651292,-0.228393268639,0.145790889189,0.288280351086 &
            ,0.081661000990,-0.074564415140,-0.402922163846,0.096518600285,-0.040542696702,-0.232250406676,0.025581795282,0.068094196952,-0.158914471870,0.063262877430,0.005957758055,-0.197516201609 &
            ,-0.007201849803,-0.033891717673,0.006337567256,0.358306591857,0.021471436072,0.100250097713,-0.445758213238,0.080605110074,-0.065773982992,-0.274905081826,0.061418400538,0.167801879020 &
            ,-0.308496722519,0.212267825059,-0.112007648436,0.038203497979,0.012981953028,0.130296444616,-0.046505326397,0.235862024854,-0.025489692701,0.087020207692,-0.313668907179,0.140023259291 &
            ,0.067240112415,-0.711338624442,0.266380710604,0.486469885182,-0.150803328715,0.542804448543,-0.437638875125,-0.430572712442,0.045293216187,-0.392964328044,0.076874220790,0.972533169693 &
            ,-0.507943740460,0.476839339491,-1.014897933938,0.555193376848,0.053118223790,-0.586982400051,0.328831720874,0.944110822281,-0.273218770180,0.039234927824,-1.064805935440,0.880960633087 &
            ,0.018259234345,0.006537341930,0.207717711811,0.982290095942,-0.322787001421,0.516028926410,-1.370549417285,1.373747517196,0.024766803064,-0.011190411063,0.045143974996,0.192295473251 &
            ,-0.004950233349,-0.080094958102,-0.292302473116,0.294060125735,-0.017611542403,-0.069600018013,0.066730743404,0.144474545657,0.080805867208,-0.165376281547,-0.211629003491,0.188857561643 &
            ,-0.008884708316,0.072836577258,-0.024560592301,0.129974480038,-0.159186417175,0.100118961807,-0.213363175713,0.294158728566,0.013943735060,0.011459751766,-0.015035754683,0.059183761991 &
            ,-0.039472191055,-0.063692031290,-0.075089696870,0.093745150016,0.028630979403,-0.008592369460,0.031799353083,0.132293038714,-0.081691159923,0.110960155839,-0.192260965180,0.192910966304 &
            ,0.036151996405,-0.093302997686,0.134830158775,0.420526246328,0.230704807297,-0.510810231616,-0.625671407392,0.681544700302,0.026645613473,0.030559402007,0.141603241268,0.483901745390 &
            ,1.302721515649,-1.042440914410,-0.712761866350,0.236283053980,-0.077212935435,0.127998487695,-0.094537944066,0.456671768426,0.052455222597,-0.196377954297,-0.605474747785,0.560018879415 &
            ,0.018649356153,-0.060539341528,0.040354884653,-0.072879462738,0.149164597868,-0.315922276736,0.101313270629,-0.041541838413,-0.021648281630,0.131919140353,-0.058295512393,0.036974679940 &
            ,-0.083954418965,0.142478259138,-0.062753558201,0.113802392538,-0.015083135478,0.093614974577,-0.039108881833,-0.055377843255,0.063271623851,-0.017717621787,0.065318792775,-0.038349223259 &
            ,0.016480315642,0.065467000177,-0.039356338993,-0.019687540979,0.063811539416,-0.092858160074,0.023310906812,-0.007129095317,-0.019754369412,0.072669003202,-0.030795295335,-0.036387187097 &
            ,-0.009500595180,-0.008060752876,0.035886384414,0.041598358578,-0.005268516574,0.067486015318,-0.019857024754,-0.005115200531,-0.035174581412,0.020301108168,-0.011351631610,0.080021610927 &
            ,-0.026494341422,-0.018482719060,-0.008239729820,-0.071661779905,0.009733782739,-0.047883920943,0.116035014585,-0.042676705848,-0.000086492610,0.058436662999,-0.003326450606,-0.017146405248 &
            ,-0.118586635784,0.109649011006,-0.006644404673,0.146232156757,-0.034832676935,0.298767207555,-0.159563441511,-0.105769930207,-0.016767071008,0.028813892266,0.110458415465,0.074126458487 &
            ,-0.038334473742,0.294914879396,-0.173666969456,-0.129926879870,0.120935939462,-0.124941185303,0.119500235937,-0.078030654432,-0.000836791871,-0.002176965597,0.000085145425,-0.038860339187 &
            ,0.065610906610,-0.073014013648,0.049141153724,-0.065058226517,0.006405686034,0.048997244959,-0.012148227463,-0.009255789256,0.056387376676,-0.072571667377,-0.007837907050,0.006218259748 &
            ,-0.007220053913,0.031224715429,-0.023272971322,0.003007575443,-0.003271659934,0.002272531620,-0.004121540405,0.015555062249,-0.005877203958,0.019584745410,-0.027496252143,-0.015976807920 &
            ,0.001951167648,0.018636539402,0.033893580542,-0.046731122508,0.004755358060,-0.015646073217,0.012636310288,-0.005190592963,0.024541052396,-0.064735729197,0.001517291345,0.007771643304 &
            ,0.002320868429,0.024290020770,-0.014998095159,-0.017537009744,-0.006729435625,0.009807519240,0.024209314302,-0.007721990222,0.002828613599,0.020173021720,0.012390768120,-0.029924994677 &
            ,0.100746846755,-0.104013831568,0.021698022153,-0.023840288481,0.000451151054,0.029289430138,-0.015469886861,0.006655895459,0.033018859250,-0.063493247919,-0.012357633037,0.011158391448 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/11.6332,7.2685 &
            ,-4.1533,-0.18733,-7.6106,-1.075 &
            ,-1.7749,7.1861 &
            ,-5.1109,-6.7795 &
            ,-1.6781,-2.8447 &
            ,-4.6449,1.5745 &
            ,1.9574,-0.32168 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-15.0578,12.6838/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/1.4752,-4.4824,1.947,0.99387,2.6476,-7.313,-0.4765,4.603/)
real, dimension(2) :: bias2 = &
  (/-0.8397,-4.0535/)
real, dimension(1) :: bias3 = &
  (/-0.038973/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
