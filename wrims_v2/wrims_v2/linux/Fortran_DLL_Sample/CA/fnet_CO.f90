module fnet_CO

! a = 6.4378e-005
! b = 0.088619

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.092700416522,0.448758704256,-0.345229060540,0.093508866232,0.453561456854,0.121366172295,-0.063737024468,-0.111034046528,0.467982306683,-0.659005181253,0.128994847676,-0.155308639700 &
            ,0.104091680170,-0.505692909259,-0.307458941761,0.043069145424,-0.363880394082,0.227084395496,-0.165231983799,-0.142148948926,-0.610647213592,0.432393690178,-0.002942818581,0.049328320919 &
            ,0.319211670853,-0.049932739358,0.636150686974,-0.120460905457,0.491612063275,-0.895675613307,0.441699638422,0.147102988841,0.107294215984,0.351663745272,2.131125360581,0.095354999789 &
            ,0.208126368787,-0.317710099482,-0.366767641976,0.032523047525,0.782761632298,-0.030878432402,-1.536651903355,0.054873222235,0.628708969308,-0.169560841601,-0.264354218367,-0.203460646349 &
            ,-0.703747143544,-0.403460154840,-0.613726746230,0.328009520343,-0.882983458565,0.394317137628,1.246401520273,0.070873625591,0.045969605637,0.037876141520,1.393700348592,-0.272958089142 &
            ,0.512789085409,-0.468673147630,-1.243044850412,-0.131742219611,-0.031239785824,-0.738537140635,2.104344473350,0.167897602664,-0.764214418916,-0.593563102205,-0.594845625402,-0.132697756231 &
            ,0.595569273787,0.431787591088,-2.555761957732,-0.029666875950,0.001232044850,0.912870912032,0.234145476729,0.042758938045,-0.125077016308,-0.421589844935,0.079878439950,-0.007912800694 &
            ,0.437439224319,-0.641411605876,0.280164151280,0.001697539097,0.021813148182,0.380135044898,1.192205658535,-0.022480446546,-0.506538637237,-0.602685062211,0.286303112951,0.004295511569 &
            ,-0.015898758861,0.737407818550,-0.090730895914,-0.142393575337,0.738063024835,0.135061996511,0.127096612666,0.114313189268,0.016347840036,0.285229768384,0.319918168922,-0.127409059912 &
            ,0.492504023171,-0.230889022522,0.010889072354,0.061249171120,-0.167266354576,0.227643167581,0.165390817876,-0.029085047755,-0.019429674051,-0.119038575572,0.091922901533,-0.038079481402 &
            ,-0.052063308151,0.198260419247,-0.034775489719,-0.147689483194,-0.186752351141,-0.235028058373,-0.434166424834,-0.205815165904,-0.275525292983,0.734813962706,0.640082023063,0.208489566359 &
            ,0.508375137001,0.431702967328,0.506536255246,0.161333175542,0.483586481788,0.006477922241,-0.293049328501,0.049720557625,0.464970927157,-0.255568700791,-0.062687597568,-0.044297095986 &
            ,0.052513850554,0.475711673864,1.710891150934,-0.008840776835,-0.058522632019,-0.920467523454,0.273910535448,0.003326110434,1.189872740706,0.465014824086,0.743449623039,0.329779192898 &
            ,1.577798133037,1.038016678848,-0.885144261078,0.282635280409,0.148327276294,0.551495026918,0.455496775513,-0.288272153109,0.386808121834,-0.952019084531,-0.348664092331,-0.218650364913 &
            ,-1.559312251259,1.387190548565,-0.879313802000,-0.155815861166,-1.885662073394,0.910903519115,1.136182491606,-0.081351516914,-0.240393113685,-0.523398143962,2.371336531828,-0.417857528419 &
            ,0.341702399731,-2.071721589133,0.763670419558,0.307077224748,0.397076597915,0.905387283794,1.007443804529,0.696286636610,1.240141315776,0.879276170146,-0.602539648029,-0.144422612875 &
            ,0.598044041789,-0.673150402625,1.449554155251,0.061295609209,-1.215287474461,-0.214552219516,-0.597450293592,0.066675033606,0.403494629737,-0.352726433177,-1.225364579161,-0.104146039224 &
            ,-0.245121745456,-0.455284138860,-0.258049247722,-0.256724477343,-0.064812903203,1.373386002929,-2.341903951960,-0.225804245755,1.004406865239,1.713635730422,-0.105717387539,0.207253667258 &
            ,0.472101060484,1.245862673638,1.357410087803,-0.569123478560,0.163011718438,-1.551364765040,0.255404457563,0.109091292060,0.408340095832,-0.506069395096,0.928116181287,0.125123785510 &
            ,0.392745821337,-0.353161106974,-0.248590742403,0.083194591935,-0.060748443800,-0.447748729016,-0.405759087959,0.042591232740,0.309143851228,0.220601186194,-0.152948253437,0.026669512575 &
            ,-0.532783077878,-0.826766386135,0.204502029432,0.226436212170,-0.400816039076,0.208148882540,0.119624010209,0.003819126033,-0.143250552013,-0.330734616460,0.245280993568,-0.015768766576 &
            ,0.296649312985,0.251855216788,0.008336056717,0.192699157896,-0.148147890372,-0.065776782960,0.922383496148,-0.217482825651,0.322246161442,-0.590494975291,0.168325796127,0.168403720389 &
            ,-0.620391597090,-0.062202630612,0.088677870027,-0.103466301793,-0.287772384645,-0.005153115487,0.454229775075,0.105237543992,0.652590246995,-0.191737260665,0.401950852902,-0.402449638298 &
            ,0.424502173874,-1.026818703432,-0.572730677202,-0.000593412032,0.286923290075,-0.290003367761,0.366474086965,0.127192784030,0.659971998312,-0.114083478205,-0.057802949901,0.085840001483 &
            ,-0.108087756370,-1.075608871877,-2.556977998587,0.379508735721,-0.622522798579,1.842020783716,-1.025271352664,-0.310895596923,-1.132136121367,1.563149421049,-0.852799945997,0.132580241584 &
            ,-1.432013530972,1.429535344984,0.173138574908,-0.347479454601,0.366102667470,-0.935359315437,-1.889543045282,0.097788827888,2.627250904147,0.515553974571,-0.508462560644,0.115256726609 &
            ,-0.001504653021,-0.086761805609,-1.174891302021,-0.001564220570,0.262711686914,0.835997732039,0.696640224052,0.412216622955,0.807069020118,-0.652235285285,0.463978428909,-0.380057521907 &
            ,2.209937213559,-1.433154225668,0.118753465002,0.372778624668,0.133200154269,-0.281910733647,1.373409114925,-0.422765644217,0.036412309849,-1.378352991580,0.784279412532,0.382460222523 &
            ,-0.205834509761,-0.793079308836,-0.355091790838,-0.516025756864,-0.324519188120,-0.240041688231,-0.316930153428,0.117829666784,-1.224743648352,0.253328177412,1.167847170265,-0.015116290041 &
            ,-4.123338199086,1.332060115382,-0.258729545684,-0.147459813933,-0.283958146562,0.018083955640,1.109898883546,0.242612375962,1.926644874669,-0.106991814181,-0.136119552599,0.040416085342 &
            ,-0.635267016571,1.169795332864,-1.335357348596,0.711439727751,0.391783686147,2.617923928071,0.732789583914,0.197708510581,-0.347651451894,0.311384638665,-0.369516617068,-0.074605066894 &
            ,-0.046206200096,0.240201228101,0.314560281870,0.043317949474,0.056954668378,0.140426450223,0.722819478843,-0.178861609337,0.254848013713,-0.951261230763,0.206329014175,-0.002618937025 &
            ,-0.049984084131,0.259090483397,-0.783670704372,0.289498841682,0.279087597282,1.146159480468,-0.068574807531,0.021771655169,0.014649419903,0.236725343613,0.352493620713,0.025086445479 &
            ,-0.011108571769,-0.044057519676,0.102820433601,0.030555882729,-0.041935545848,-0.500531803832,-0.383416424002,0.127645551451,0.276423270194,0.308059355914,-0.014053155439,0.057356104029 &
            ,0.191783785967,0.430412001927,0.342254663191,-0.226487317180,0.346852231150,-0.524946374562,0.031656055015,0.048240979087,-0.259992415363,-0.150928346482,-0.231570288029,0.023005277047 &
            ,-0.027423856678,0.089952391821,0.242878709068,0.035162193268,-0.021078636564,-0.038843758468,0.136305870715,-0.044286353870,-0.273521173181,0.400054533858,-0.085224595088,0.146746484992 &
            ,-0.302952489548,-0.438517465838,-0.685895779379,-0.060653367836,-1.894010607903,-0.151096041789,0.840533722214,-0.033287288859,3.231955544927,-2.051509211921,1.125490605122,-0.158832212695 &
            ,1.374999739459,-2.784626004614,-1.081517393361,0.062089309495,-1.003697561738,0.162139830599,1.411562232461,-0.981528889621,0.055671025028,-1.545475618233,-1.451340551658,-0.417815345443 &
            ,-1.913170694884,3.619652489808,-0.072407717148,0.075254896155,0.547784665007,1.947410934203,3.086625671904,0.760122678515,1.001419049630,-3.968052253901,0.081747248287,0.826561584910 &
            ,1.559625398779,-1.114643119059,-1.432180720560,-0.385278770379,2.114287864059,-1.114518555267,0.338245820157,1.661911023611,0.719147647040,0.899223903930,0.580100619441,0.055931655805 &
            ,0.792126810148,-1.661821610329,-0.191942806384,0.922697457634,0.771484962852,0.741962072064,2.744461823425,0.988016745897,-2.605116094730,-1.289926607071,-1.750537387093,-0.851014274613 &
            ,-1.000357753813,-0.752109104534,-3.902485101199,-1.747919029780,-0.741465137506,-2.415320481084,1.021873877070,0.841865084590,-1.403996598637,1.173055141736,-1.595817097725,-0.708264745874 &
            ,2.137970056924,1.999429795662,1.706105216078,1.128252941585,-2.713594528421,1.826853437895,-3.520023706597,-1.454866101872,-1.250153255522,-0.826849575585,-0.751850819055,-0.028399015876 &
            ,1.736979434400,-0.282340961097,0.602713357951,0.023302791588,-0.806749093745,-0.299749322124,-0.449716205886,-0.048730922200,0.935851123873,0.008945534476,0.399936772929,-0.133660173735 &
            ,-0.200589673674,0.282999806562,-0.347404053668,0.311631437134,0.092236904149,0.165094079338,-0.253614605016,-0.181559942522,-0.062819041188,0.455707567980,-0.243406620998,-0.039816142688 &
            ,-0.106950516171,0.061308411836,-0.218686462123,-0.360298330540,-0.303073855389,0.523926469911,-0.277130226677,0.003185273496,0.562279465836,-0.513805311875,0.030229661447,-0.488247969952 &
            ,-0.108913825919,0.478158219222,-0.459316018082,0.771650195580,1.461340530022,-0.737512247667,0.199090879054,-0.287679239887,0.102317959908,0.770601923295,-0.475555539774,1.210830623260 &
            ,2.502901417500,0.143875022024,1.104395163116,-0.759912386881,-0.681249541803,2.004570883624,-0.310924040448,-0.181995902999,3.731315791863,2.035058104567,1.619836031431,1.372682946673 &
            ,0.041542206019,-1.865687772726,0.454547492910,1.368679065152,1.795250926312,0.703691369916,1.261463104639,0.387612599748,0.446378297226,-0.072274888528,-2.312280735870,0.120721320360 &
            ,-0.588382800447,0.992993527897,1.013229316199,0.232058575649,-0.282076908492,-2.770993272738,-4.130679578700,0.602746359480,-0.876464012520,3.530263859532,-1.923269032831,-0.289890278924 &
            ,-1.317786034984,-2.989328333616,-2.298874989347,0.806536939894,0.095142319810,0.243727070079,1.365073497792,-0.174055811095,-0.911166499355,-5.755345956021,-1.071716642797,1.484080245232 &
            ,1.002898712756,4.185342642768,-1.526779133378,0.461126078777,-0.537971752774,-3.889929754534,-1.269559162689,2.021848962035,1.509455494020,2.425234374784,1.195061851657,0.172912924961 &
            ,0.445323412353,-4.327419856367,-2.811125994820,2.073232623432,-2.237185934036,3.006840739032,-2.022686006416,-1.173552885057,-2.530048008947,-9.713263107373,0.069359345087,1.426633308271 &
            ,0.692187724548,-1.272945000536,3.352215395595,0.631012608344,-0.899471739495,-3.690341112282,0.251396744410,3.256618173572,-3.418038331736,4.486169829582,-1.057328434587,-1.592973536265 &
            ,-3.766114228497,-1.462697327872,-0.462668900467,5.585688097742,-3.978309847033,-1.183016615756,4.027613148028,-4.824816338883,-0.586964043392,0.247751862248,0.215072177353,2.342036381907 &
            ,-1.768814158034,1.505678917857,0.938871971983,-1.217814996535,-0.147547056937,-0.125524553448,0.652030600192,0.630071328711,-2.051351183035,-0.821538579518,-0.024119544213,-0.983085360562 &
            ,0.088087867824,-0.652292690738,-0.715929204726,1.672266237133,-0.082343648819,0.898536391066,-0.746078070048,-1.217626955275,0.555697809725,-0.238826926564,-0.749519606542,0.895680164340 &
            ,-0.130734776781,0.267560367386,-0.854503079600,-0.974928914415,-0.143013883816,0.643494467370,-0.572231154493,1.136470335535,0.343870550579,0.011273041196,0.284710078018,-1.038045312677 &
            ,0.191004838531,1.130672361817,-0.201253639358,0.077432863589,-1.470319735635,-1.349746628118,0.550054760471,-0.889167083110,-0.873788165728,0.808352450288,0.427179361667,0.805177747476 &
            ,0.479092704658,0.327893537907,-0.319502065261,-0.837804186197,0.055149478167,-1.280068310996,0.815449832823,1.173321674424,1.846829200144,-1.013845034325,0.212995166878,-0.615243135337 &
            ,0.058108420901,-0.370984067504,-0.205264744714,0.017009982172,0.101852060137,-0.075810399812,-0.143538269180,-0.034156258963,-0.300868897430,0.283123631765,-0.279980605583,-0.071305454799 &
            ,-0.446226281732,0.173872353349,0.195752524496,-0.023877540509,-0.027206222598,0.849733882127,0.915634087851,-0.173377035530,0.039557373000,-0.321463272721,-0.030020278059,0.001256135527 &
            ,0.357371938329,-0.396118413698,0.341041770415,0.000739550423,0.158520197729,-0.403702555979,-0.061482789818,0.063048470854,-0.353194780191,0.195333946078,-0.676952366581,0.023255089518 &
            ,-0.377989685562,0.501913002767,0.067973863406,-0.072694240417,0.238559824990,0.430309900631,-0.085204111210,-0.177971610305,0.120786947169,-0.298791987739,-0.154695855542,-0.051260811639 &
            ,-0.063753908419,0.140861285643,-0.137110043059,-0.026579230503,0.175199504327,-0.065070217020,0.172256606959,0.037521745675,-0.054603315293,0.470538621814,1.022101972726,-0.051255075040 &
            ,-0.222356139602,-0.092383830196,-0.030701112194,0.070479823841,0.355202020383,0.666460840811,0.367605595699,-0.441867016198,0.258337167199,-0.785712004663,-0.093167999305,0.076295376709 &
            ,-0.184464334177,-0.967203978525,-1.451558978438,-0.068467548022,0.083036169588,0.815659798608,-0.138308185087,0.249592235815,-0.098261549182,-0.110148340080,0.000555735226,-0.179000730876 &
            ,0.017842040477,-0.139938103728,0.019700722310,0.090625849566,0.144447784251,0.176093402705,0.394768276481,-0.054153018324,-0.004301709075,-0.144469355863,-0.004417978184,0.060164212708 &
            ,-0.078187026269,0.092038348890,0.026061352523,-0.101276987048,0.049588240146,-0.000979391122,0.024433271214,0.065130440678,0.090652910207,-0.006967779515,0.295960276978,-0.021777557731 &
            ,0.135000303250,-0.140350905046,0.042213461362,0.073764380477,-0.092827011023,-0.093746379368,-0.282854757874,-0.058872083862,-0.012015242854,0.185566581276,-0.002052507651,0.059289432963 &
            ,0.122071336875,0.072049158412,-0.258372359170,-0.087044472143,0.175896752145,0.130305869081,-0.134719740327,0.054452472842,-0.181663225720,-0.196278195368,0.464875223696,0.097567566009 &
            ,-0.152835272501,0.159999922644,0.066530754298,0.080899552141,-0.078938238780,0.223571239935,-0.409400951432,-0.074975485477,-0.123344380872,0.221665138708,0.075063683621,0.017476737868 &
            ,0.063132291820,0.184963937654,-0.140638418921,-0.029935382629,0.080701711870,0.013909915242,0.014115087690,-0.003121198599,-0.067159347687,0.042596838269,-0.005188395472,-0.014384090716 &
            ,-0.031348388873,0.021638810011,0.053827979474,0.010177520995,0.034986379374,-0.218023729221,0.233336886991,0.031452606770,-0.008192335437,-0.120609283875,-0.053836980192,0.001799636708 &
            ,0.003070027980,0.224602953333,-0.266041135312,0.041214773816,0.087989713999,0.258467893240,0.036416426766,0.000418501564,0.011567699989,-0.167967866835,0.055134218852,-0.029306228457 &
            ,-0.092159078972,-0.160491658730,-0.054471239650,-0.023670811831,-0.009729610674,0.070680145473,-0.074063298418,0.023825928319,0.061448963397,0.134153053536,0.010951355926,0.015276815921 &
            ,-0.038502717988,0.152513066848,-0.216868531565,-0.024404926445,-0.061265355328,0.079514784390,0.039220234475,-0.019179263792,0.072217677117,-0.126930595047,0.124041745599,-0.019118633630 &
            ,0.099127326886,-0.153018626595,-0.064687323720,0.003692151828,-0.001144992520,0.054881535550,0.059211828061,-0.009541611506,0.009239332231,0.027858495623,0.016617292962,0.024483070673 &
            ,-0.036609286830,0.107104454936,-0.253493565975,0.034650834470,-0.007890984669,0.172297365319,0.041761101002,-0.017938057775,0.034696104234,-0.007993403772,0.110608836260,-0.024648719626 &
            ,-0.020193300287,-0.046063139029,-0.072150014381,-0.000276325678,0.008554991502,-0.086161258805,-0.030992411351,0.015421290166,0.008885387314,0.045836168673,-0.034738559845,0.005492452830 &
            ,-0.044926475974,0.039461357252,-0.001126581816,-0.018342088654,-0.045509921508,-0.024631910221,0.035345056212,-0.004009791575,-0.033988177600,0.046730592566,-0.041025149077,-0.022625724799 &
            ,-0.053856730788,0.003467477901,0.036636387363,0.002636610821,0.016305622560,0.007195844742,0.023029777585,0.004684411393,0.075318213788,-0.000215142708,0.009713327332,0.013934093179 &
            ,0.028739732958,0.019725146844,0.011323770662,0.014973732374,-0.021516805847,-0.006636019328,-0.002683462381,-0.009946333601,0.066945199720,0.025356989789,-0.012148007211,-0.026386885881 &
            ,0.061684977370,-0.065186133040,-0.008548925867,0.006166554503,-0.003268223388,0.006404548328,-0.145089350967,0.006034408057,0.038698726173,0.075841027297,0.005603496488,0.002468612057 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.0532,-2.7929 &
            ,4.795,6.6028,1.155,-1.2571 &
            ,-12.1557,-1.3316 &
            ,0.060117,-4.0863 &
            ,3.7294,-1.3773 &
            ,3.4549,-4.5066 &
            ,-0.18582,13.4437 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-10.3614,11.204/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.74073,0.88831,-2.8183,-3.1417,-1.6206,-1.4921,1.1067,1.0937/)
real, dimension(2) :: bias2 = &
  (/-3.9575,-2.0286/)
real, dimension(1) :: bias3 = &
  (/0.10217/)
contains
subroutine fnet_CO_initall()
end subroutine fnet_CO_initall
subroutine fnet_CO_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CO_engine
end module fnet_CO
