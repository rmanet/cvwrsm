module fnet_Victoria_intake

! a = 0.00086483
! b = -0.044999

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.113891534234,-1.129885978508,-0.295983590483,1.092692881151,-0.147440806961,-0.459147388423,0.281068294342,0.274275361918,-0.080596049492,0.932769579964,-0.354092140191,-0.039197726119 &
            ,-0.131646223825,-0.454248728990,0.009759787886,0.009625974678,0.120646754199,1.450385532562,-1.891505520906,0.224230074092,-0.920020913577,-0.623803143332,-0.908976454638,0.145407486570 &
            ,2.047850321747,-0.875812135431,-0.022966084976,0.161097795228,-0.385860770057,0.696786465967,1.328204820658,0.050192448245,-2.021901498557,0.203647821840,1.469643749627,-1.051697028055 &
            ,0.673756300867,-1.585598899739,-0.089236556956,0.363040505460,0.560833938594,0.553629783401,-0.953133814007,0.118558869921,-0.523564941316,-0.906513876844,-2.765456505613,0.418938577514 &
            ,-0.003095475516,-0.106228759502,2.551717053138,0.333948328988,0.834154012625,-1.242245922650,-1.477300205018,0.467697480085,0.405243638589,-0.530762341762,0.101701421346,1.174782250386 &
            ,-0.244953563221,-1.880323188059,0.183112757758,0.663836541511,-0.311024430580,-1.831619885259,0.456424572851,0.196198525930,0.215566375774,-0.248012801995,0.585937250753,0.113992653244 &
            ,-2.098444784624,1.227176611868,-1.793728989689,-1.268724941540,0.793262301407,-2.199647159321,-1.464375175238,0.503282592622,-0.323614373758,0.000487206414,-0.113613160788,-0.332856648453 &
            ,0.189656282759,-0.549760234807,0.477211076036,0.169007042002,0.067523520778,-0.067582957480,-0.887953814668,-0.329976659041,-0.173325101441,0.155021062461,-0.209768120562,-0.039226157094 &
            ,-0.278951308817,-0.127086253246,-0.059962541819,-0.423449350335,0.061061422007,-0.097576621699,-0.085832179277,0.042342533895,0.333681475170,-0.089061755559,-0.837245152448,-1.397455258239 &
            ,-0.359656144946,0.358148026174,0.259060485474,-0.105894352286,0.375350427308,-0.759272809951,-1.559492554890,-4.812179946670,-0.577464221427,1.136062971734,0.301526686480,-0.314483929172 &
            ,0.052767440944,-0.186907196139,-0.116930866040,-1.733645160467,-0.144046754428,0.269559615591,0.106604565787,-0.057053366899,0.244839994924,-0.120230215071,-0.290230356358,0.065296736280 &
            ,-0.226833555094,-0.062569951434,0.263554672894,0.073428291639,0.359063307150,-1.035700499020,-1.501523046620,-0.890074616017,-0.610596793478,0.373340837811,-0.155735138515,0.037445589374 &
            ,1.394360055539,-0.653945667185,2.945842346070,0.073196467093,1.200210227324,0.532422906464,1.628167955006,-0.090490343114,0.995682376152,-0.157531011912,1.448453983652,0.863697730105 &
            ,0.103595097384,-0.197877833065,1.023697524325,0.131615387814,0.017094805730,-0.717597172691,0.892143921764,-0.633618597661,0.717156064986,0.514219084515,1.531251682278,-0.228500701435 &
            ,-0.657086659057,-1.178449040754,-1.520475321736,1.444145409544,-1.007728162848,-1.294575919254,0.008098487386,0.302090404649,2.276584134762,-1.064280051324,-3.633123155958,0.642392184385 &
            ,-1.885545983215,0.443406071837,0.683589293509,0.025513957039,-0.626908025624,-3.134089069964,-0.996485822836,1.479198417026,-0.017510985614,1.125643078706,2.071647957755,-0.463802306812 &
            ,-1.240437194770,-1.235098512221,-1.183584357706,-0.236421940475,-0.178600528439,0.301611225013,0.322012976825,-0.469045935159,-0.808208620421,-0.602848485099,-2.898103920038,-1.292237557500 &
            ,-1.556082605879,-0.932444697456,-2.575446026205,0.122161469265,-1.050747592811,0.175387303097,-0.679624529743,0.023754337532,-0.492616544158,-0.649964947751,-0.268603103168,-0.051994835079 &
            ,-2.270649723086,-0.087842421366,2.115259988208,-1.531922817548,1.037255194224,0.355249591634,0.192061457131,-0.450640781361,-0.560501971439,-0.036842307634,0.100301018584,0.179067846510 &
            ,0.402853537235,0.661752470643,0.335068325265,-0.334807835800,-0.282277036958,-0.010639031887,0.472361854692,-0.267311251202,0.161003120568,0.032404695061,0.075036448710,-0.072768361957 &
            ,-0.579068526602,-0.072416399558,1.053481184308,-0.105013054144,0.457551687158,0.225510206112,0.565379628598,-0.175071829448,-0.421993707161,0.074624520034,1.973051062689,-0.217646898015 &
            ,0.823649594061,0.056824921271,0.577661620308,-0.071098632216,-0.047820321863,0.285658269776,0.448522784108,0.986294851431,0.236422238900,-0.124114514934,-0.040361540196,0.066450012120 &
            ,-0.014462371263,0.179392229493,-1.513010300133,0.724268219256,-0.586159013259,-0.059487931612,-0.412972797725,-0.019868940294,0.057816947999,0.583531416690,-0.300333396372,0.128057085727 &
            ,-0.125866020266,0.010034847369,-0.185102781151,-0.014782550835,0.526216319123,1.091490101563,-1.993054464473,0.257676665391,-0.426431517929,0.394544445448,-0.702772189529,-0.152311718193 &
            ,-1.119843353941,-0.355566529546,1.140533048667,-1.384578644399,1.090488762505,1.728441548960,-0.347464883059,-0.634152055932,-2.586025184441,-1.244180837666,5.363782814562,-1.973417526157 &
            ,1.972574690732,-0.824833316619,0.734011995186,0.152035348853,-1.685029108203,-0.584715069875,2.649958972787,-2.368806785345,1.647270458892,0.803422125864,0.193424817157,-0.446502871332 &
            ,-0.675660810058,-1.119419796864,1.972437050820,-0.849661704361,0.490202410440,-0.345402747819,-0.177941554486,0.241542361419,1.257481429213,-0.554996722942,-0.484885171061,-1.952024773091 &
            ,-0.237734355288,0.971792972028,-0.405731839697,-0.117494255092,2.723066422808,-0.371184120379,-2.551892477883,0.692242127294,-1.527816558672,0.096642696666,-0.133205913660,0.339211637846 &
            ,3.017008173643,0.377741171342,-2.792114234547,-1.107114688226,-0.892108967289,2.342796877733,-0.218974468822,-0.515604670154,1.579067920150,-0.104867906927,1.003648164418,-1.050172579996 &
            ,0.127584518710,0.880913450394,0.964752213794,-0.095795225460,-0.414375763169,1.035711243004,4.689209430353,-2.437281986093,2.153265010410,-0.280222328192,2.584946937294,-0.398686434359 &
            ,-1.836972099450,0.405930400860,5.761283626686,-0.231436727267,2.169694042586,-1.622693991504,2.126003508268,0.066468459471,-0.185613049326,-0.081765020710,0.682554380704,0.374470053441 &
            ,0.079025624545,-0.580427839449,0.142695031237,0.162261109370,-0.152956091780,0.033859658716,0.323542459035,-0.636288241947,0.167182065221,0.045166297268,0.223930983592,-0.064791093638 &
            ,-0.346851917384,-0.023635593205,0.897290099422,0.183258481493,0.301633776919,-0.415089192292,0.220761263452,0.063350559077,-0.141030264312,0.087719370637,0.775226396786,-0.405590597002 &
            ,0.269612893714,-0.125589630808,0.216737827638,-0.005290649105,-0.115904737174,0.143462272850,0.123046810426,-0.011568143160,0.059848968461,-0.239465671388,0.078173838567,0.021045192502 &
            ,-0.304879072861,-0.109807143673,0.807467232008,-0.206939674899,0.283625579255,-0.113290651686,0.233947304868,0.013647539507,-0.030988563967,0.071176856474,-0.161361160776,0.358129547679 &
            ,0.055112798276,-0.032837626080,0.068607150077,-0.024848089376,-0.280286554864,-0.030098225442,1.192129597191,-0.951199994272,0.312586901625,-0.041964280179,0.224668557948,-0.023813415202 &
            ,3.025843489567,-1.624989954330,9.593473526343,0.274334209132,3.167220729564,-0.047631114473,9.999136130971,0.452843253116,1.701339238257,1.054667059519,-1.930161936655,0.674823533783 &
            ,-0.967840501971,0.077475915876,2.237005619063,-0.204918326848,-1.732298866837,5.392944878473,-1.598637964916,0.878618151539,-0.776735060531,-2.177739400081,0.816949802027,0.418399990062 &
            ,4.725545244725,-2.381935870031,3.987561422062,-2.269892307384,1.693880398286,1.654384542735,-4.744436202730,0.515404891415,1.093034809572,-4.832190336847,-0.416232509070,-1.797398846641 &
            ,0.776759476713,1.149179814268,-3.622898074467,0.550182492512,4.052971375753,1.109908333405,1.962511781362,0.433077666170,-1.191854147698,-0.838487252496,-0.835877337090,1.460972254628 &
            ,6.537587845036,-5.159076427160,5.359424646689,0.871675758866,1.066966105352,-0.553250185703,1.464251942582,1.914120811474,10.436974586042,-7.229311581184,0.860533774189,1.788746232193 &
            ,1.399032257152,-1.088941892194,-0.532297547745,3.322057441773,8.446087093876,-9.968635649771,-1.418776556648,0.998873095804,-2.973691953590,-1.294395558129,2.630108169685,4.530499456385 &
            ,9.444183005168,-0.015838141947,-6.551346452184,3.100694342327,-4.085242829553,-3.828639118602,4.700501714025,3.908586635700,1.833791338678,-0.931486011375,-1.620280673124,-1.245687586609 &
            ,-2.376859172976,-0.592225679753,-1.091568908620,-0.380323238066,1.857642512116,-0.059906947258,-0.518974255583,0.790913655593,-1.417610034140,-0.442531250511,0.089765266510,-0.038407826694 &
            ,2.697247420366,0.849896862274,-0.515204215797,-0.080727091418,-0.217627726613,-1.050630687582,0.852635778180,0.497761767476,3.696041696478,1.546320331760,-0.705789373641,0.395357234313 &
            ,-0.682121054861,-2.905345961291,0.522619041056,2.084570599687,3.811173388939,1.900143223829,-1.579414334195,2.106597248072,-2.609721689576,-3.670749160444,-1.341901886244,1.824488558805 &
            ,3.463017336896,0.721017733066,-3.330001685181,0.644045937672,-2.469993256094,-2.524584501294,-2.204354016348,0.026914973567,3.634323867929,-1.213656869978,-3.642692213830,-0.811300922115 &
            ,-1.601065306189,0.555679862928,-1.534495252975,2.330723020387,6.546333610327,-1.897830420332,-1.338273914918,-0.257765356492,-1.759598629344,0.531950112040,0.847625406296,-0.112583913296 &
            ,0.036068852500,6.488655689539,-1.355453659164,1.075529080794,-0.418120005218,-0.450467495502,-1.401403754467,-0.278251734108,-0.217249093996,4.380392691471,-0.541194400286,1.197351955869 &
            ,0.033044775477,-1.537881481104,-1.220295894499,0.728768109763,-0.883728294491,6.072248273039,2.087142319782,-0.647794237384,2.682692988378,1.004411838009,0.010034319050,-0.455739312830 &
            ,-0.296609156149,7.083333996409,-3.704249574962,1.814795428890,-2.103195800656,-1.360748299366,4.886604004314,0.676930553449,3.597915104929,8.724127754773,-4.393816411235,1.027782394696 &
            ,-1.910883882488,0.190547623413,-0.303934777626,1.983151114742,0.021401174291,1.936973696922,-2.167662551399,0.102120832463,0.895351725074,1.086375080908,-0.768098130863,2.507965240903 &
            ,-2.290768740214,1.009858931936,-3.062071601205,-0.460492607082,-1.022912858770,-0.661756321122,-0.988468481721,4.232778471352,0.062519136367,2.991273206418,-0.681558920744,-1.449870531411 &
            ,-0.292869343204,-1.144671177401,-1.635007105101,6.530943160021,0.397319893483,-3.842493453362,0.694541466944,0.914870601057,-0.181473077833,0.194871012471,0.632628731442,4.607821162183 &
            ,-0.505014809621,-1.338227524608,1.944954690466,-1.480642075108,1.368135420082,1.720878638740,-0.238288702900,1.566043054698,-0.648727384007,0.786329681805,0.091230116415,0.076705477532 &
            ,0.699199567692,0.335468471588,0.213593535447,-0.240863722556,0.529024076700,-0.410072026260,0.896366747982,0.005344073785,0.430168511735,-0.466468291842,0.758569121719,0.303145612613 &
            ,-0.014110932683,-0.137404327492,-0.243037042570,0.172793295489,-0.372264577175,-0.461733999912,0.052329831986,0.163039879186,0.218865256779,-1.097482784409,0.841114521533,0.310215283809 &
            ,0.004096910182,-0.374763659149,0.814579873410,0.220827464644,1.877505515324,-2.339804800455,-1.399370635798,1.310124793073,-1.743182549944,1.697601898358,0.941633887285,-0.176648239656 &
            ,0.368141963615,-0.572438583671,-1.270642093149,0.936126773344,-0.766190507808,-0.473428217664,0.511751915859,0.104808953118,-0.012649882865,1.203667091512,1.061582572071,-0.095365482758 &
            ,0.511459374141,-0.177829342428,0.422401071846,-0.070842856417,-0.909094429744,1.127205346271,1.060814963145,0.167626714335,1.083369815724,0.450239327214,0.287736758859,-0.458518107010 &
            ,-0.143796092222,-0.656839882298,-2.661289388562,0.126495794610,-0.922788653125,0.135101973649,-0.702404912225,-0.015128825405,-0.027405995428,-1.188946504677,1.952963141682,-0.092141878026 &
            ,0.676229131268,-0.041801366447,0.459624281781,0.090526320457,-0.056635809172,-0.310002952333,-1.185830134668,-0.056619570055,-1.092517885208,-0.190235100726,0.219655013822,0.026404963010 &
            ,-0.052911019682,0.367625984730,-1.359454376823,-0.508945420174,-0.160118172542,0.253756170114,-1.278061605016,-0.120220083134,-0.194296702959,-0.803868413445,1.748962430451,0.349437266949 &
            ,0.975825101102,-0.026840305421,-0.226073337166,-0.096694901685,-0.180290864369,0.050540474732,-0.672526308536,0.465654436280,-0.827256474026,-0.628770057497,-0.454739777230,0.016716148759 &
            ,-0.593259868952,0.069051418778,0.503116006108,-0.623413048816,0.520468675543,-0.127543465295,-1.066941917172,-0.267680290750,-0.331751627118,-0.162232903806,-4.595293902699,0.637315459085 &
            ,-1.987012412036,-0.044596202014,-1.474378547986,-0.516760085492,-1.366979867217,0.656196407568,-7.221129627239,0.159856382912,-1.258401596190,-0.096125153229,-0.950028414120,-0.571994432014 &
            ,-0.589984315689,1.976708918817,1.430659589691,-1.156883720369,-0.227806696979,1.587626895183,-1.623798036382,-0.934099028019,0.247385806062,0.715820608182,-0.721253046046,-0.129392309891 &
            ,-1.077679131671,0.251486864576,-0.801836466270,-0.093101762537,-0.075466568955,0.313104164164,-3.098354060335,0.082199046196,-0.595307595786,0.112241903771,-0.479253031706,-0.063005043474 &
            ,0.002909231222,0.112906041232,-3.330976839949,-0.137069418115,-1.258369509932,0.397452144382,-0.401355401894,-0.155936004703,-0.259554144579,0.155369722960,-3.455275204440,-0.243479712409 &
            ,-0.627380053768,-0.098449888694,-0.442480987414,0.014653613880,-0.335512881636,0.088042554051,-2.020222890955,0.197019450707,-0.611716110804,-0.123998737154,-0.354155765628,-0.011503799188 &
            ,0.066401179700,0.227208103465,-1.013091135718,-0.369257410523,-0.627786425949,0.311091992754,-0.485538909620,-0.085058514890,0.064230114837,-0.049346663014,-1.047132927064,-0.567863660717 &
            ,-0.744708338636,0.218908141275,-0.196038084620,-0.059212685409,0.375091179547,0.136633077681,-2.421102715470,0.090679050226,-1.219186135980,-0.146075304437,-0.549845616950,0.077488048842 &
            ,-0.067460433635,0.185706722926,-0.131561646595,0.018500826077,-0.062552746720,-0.125388594083,-0.009547711805,0.020794886724,0.104003839464,0.135610923406,0.061175171360,-0.179019001075 &
            ,0.001664486372,0.048337156722,0.063327286845,-0.022811427923,0.035866521197,0.330828752139,0.060221378035,0.171496935267,-0.000917228812,-0.094272515042,-0.051752469601,0.008467011550 &
            ,0.035923941277,0.467722891541,-0.272909696100,0.050229363707,-0.047766994296,-0.034574360320,-0.385756578999,-0.011358485403,0.005724673138,0.127068182858,-0.137199347553,0.057282404826 &
            ,-0.070422012683,0.026137738712,-0.037622864872,-0.014888345475,0.053687444570,-0.033264301007,0.041051824143,-0.151539042476,0.025300094649,0.113479218185,0.205198716575,-0.024675757168 &
            ,0.111526395466,0.269148043090,-0.344997763697,-0.112054769175,-0.117343282991,0.159964610054,0.101853406321,-0.058438787698,-0.036757225345,0.650615629844,0.007669243128,-0.032845261523 &
            ,0.084907556166,-0.017827619512,-0.173474273335,-0.007179802649,0.061249448807,0.401776464461,-0.225553064364,-0.017946626139,-0.059107640611,0.036638774484,-0.252476809560,0.047926383622 &
            ,0.124301880379,-0.372134847330,-0.472653155562,0.145380011893,-0.235130529483,-0.165461067851,-0.263858587516,0.234560696916,-0.000397582289,-0.177801512136,0.280411521190,-0.057765311176 &
            ,0.072984552915,0.024089903024,0.081571522940,0.005655366775,0.006310357273,-0.069100047410,-0.007172490800,-0.036989953825,-0.003841886237,0.021501050952,-0.008493087272,0.003259099635 &
            ,-0.007640788853,-0.039494736576,0.164987580579,-0.016915585510,0.052999952665,-0.015932690803,0.044039160826,0.012007374686,0.010520458895,0.002958381532,0.040604632495,-0.023555851368 &
            ,0.017604244760,0.011259881408,0.008490383011,-0.002521963918,-0.008790253439,0.017596167181,-0.019103160725,0.015003156521,-0.000164888185,-0.026224587352,-0.044407334409,0.013940866028 &
            ,0.019172067279,0.017563725316,-0.073362698253,0.060678375611,-0.038244925374,-0.020356514740,-0.051030853226,0.009199210533,0.021049943002,-0.030760347433,-0.093804322519,0.007315731482 &
            ,-0.039337953256,-0.000372253636,-0.012650648081,0.006880753905,-0.027574458050,-0.103442388951,0.070608252915,0.042675898480,0.026872724413,0.017898115702,0.002863237906,-0.002341800019 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-1.8884,-2.4573 &
            ,5.0273,0.21075,-1.7719,1.5272 &
            ,-1.2846,2.3034 &
            ,-9.915,-4.1007 &
            ,7.3444,1.6989 &
            ,19.165,-0.65997 &
            ,21.454,-0.029145 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-2.1278,-5.8404/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-3.8548,6.0449,0.79368,3.9507,0.058699,2.6653,-5.1846,-3.4268/)
real, dimension(2) :: bias2 = &
  (/-16.6154,4.7408/)
real, dimension(1) :: bias3 = &
  (/8.045/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
