module fnet_MidR_intake

! a = 0.00086609
! b = -0.051134

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.009094479102,-0.946292007689,-0.635242693574,-1.210813668955,-0.046195396331,-0.172992567206,0.419641233811,1.051893650578,0.439814229122,0.523874906495,0.533282541989,-0.657181566718 &
            ,-0.249008497477,0.012384545366,0.426152817716,-0.336283326701,-0.145383494263,-0.729153482180,-0.661350248905,-0.137672510320,0.205940425640,-0.047102571297,-0.068590526250,-0.411141793266 &
            ,0.997018371167,-0.249215395565,-0.123219194361,0.803167178012,-0.395098287333,0.006615690260,0.276852367866,-0.815244266880,-1.716823843522,0.631785700758,-0.319783672839,-0.795669465056 &
            ,0.171296147595,0.037154445753,-0.930860217365,0.149817147054,0.417298256972,-0.893269811305,-0.237986558593,-0.474097503021,-0.672970443341,-0.034022378027,0.056224292101,-0.340415359666 &
            ,-0.051503390973,-0.601478847777,-0.338234084828,-0.665333514940,-0.507645495750,0.023366757803,-0.111381917926,-0.123369571407,0.312530763435,0.390445985416,0.284010980559,-1.349974145680 &
            ,-0.384361037214,-0.328512276255,0.468419726821,0.446374214821,-0.526945726328,-0.845712677658,-0.827179948523,-1.920065235944,-0.143343021793,0.049031451545,0.175570655109,1.406635969197 &
            ,-1.667268179756,-2.075245717621,-1.905213129171,0.295471404951,0.210231103785,1.491466369811,-1.495960908457,0.571611563955,0.192074082165,0.330090943136,0.282253823538,0.031012216619 &
            ,0.159897383896,0.612165343937,0.199307445487,0.023264662610,0.239943419196,0.230315816459,0.165070850057,0.098441064016,0.167718377790,0.398108589481,0.243260597146,-0.131901713128 &
            ,0.210968354911,-0.201243796649,0.004672139717,0.158077446911,-0.001657352999,0.375777390425,0.066967597600,-0.080182775550,-0.012505935547,0.332232538359,0.191191432548,0.134784031410 &
            ,0.109631264628,0.961770919293,0.046100706002,0.076592575136,0.076133637273,-0.061051606109,0.011385042067,0.117285068320,-0.047055221663,0.713531712623,0.050970711480,0.289053920841 &
            ,0.041097904197,0.122047596705,0.126713894710,0.315904352674,0.147277562691,0.623549885239,-0.021606439841,-0.012334408253,0.097595199205,-0.300824732719,-0.124051580470,0.057720877970 &
            ,-0.077467804431,0.114352502102,-0.001606917563,-0.027491757536,0.123204342137,-0.966143084016,-0.519193181644,-0.641656092193,-0.161905047078,0.283754772217,0.388791940964,1.311022821975 &
            ,-1.052560448266,1.085615305586,-0.481880486442,1.299411131508,0.408547325289,-0.425715097415,-1.147758742094,-0.844489130756,-0.112307924976,-0.057218835595,0.373474553372,0.309813842888 &
            ,-0.260768285190,-0.161268054859,-0.434038205427,0.168358547669,0.226538527715,-0.999793938670,-0.503481428616,1.666124670017,-0.741419405961,0.028096660363,-0.497420318894,1.726658714696 &
            ,0.508943183380,-0.870988064538,-0.307796480186,-1.266370703610,-0.057666179308,-0.204643453409,0.924291084183,1.637938111316,-0.484675988735,1.301192244156,0.708939082195,0.975426183990 &
            ,0.656584767065,-0.169710836394,-0.465222172617,0.064165669374,-0.174502933058,-0.428277967245,-0.518422522248,-0.948463207666,0.547383939625,-0.054071486227,0.386047660792,0.621804782501 &
            ,0.088467192523,0.383880109699,0.364572321919,-1.048241949265,0.562400454069,0.081366382665,0.555541893434,0.908597766793,-0.418945708908,-0.809272308900,-0.316036388143,-0.399862223137 &
            ,0.230447764549,0.211137882904,-0.257312838759,1.263072850551,-0.311383115043,-0.255118881587,-0.266805694177,-0.758458358617,1.314570524068,0.035788226671,0.308996695964,0.485889780596 &
            ,-1.318253871707,0.524124224246,-0.136584528454,0.852311714888,1.080132339852,0.228590466018,-0.997098632898,-0.769322334272,-0.129897528355,0.166369633764,-0.081771742572,-0.082917356746 &
            ,0.182546950885,-0.026194706873,0.076667467347,0.027277315930,0.029038455493,-0.003290168571,0.025886414237,0.195001195550,0.029971530597,-0.017188528517,-0.025525300938,-0.023262591626 &
            ,0.070692782811,0.354306643400,0.276449092289,-0.167574314102,-0.037496808339,-0.050636203483,0.053394268327,-0.397983463372,-0.021721703049,0.206339286059,0.183808034519,0.311208866055 &
            ,0.094398497387,-0.045163965261,-0.098769603387,-0.368286321553,-0.034840314089,0.325882271129,0.247489258818,0.266648306892,-0.025074831399,-0.101836795193,-0.093835174516,-0.071627263583 &
            ,-0.219176982296,0.036998834028,-0.025770031422,-0.027426618525,-0.093094296604,-0.321026708204,-0.188117605815,-0.105548890728,-0.004573390937,-0.281154505073,-0.078265321285,-0.248890046323 &
            ,-0.147818825538,-0.304318766212,0.027328618482,0.438940901958,-0.228672823291,-0.818685362207,-0.425350637198,0.032739072149,-0.015575465088,-0.119857025058,-0.163882094015,0.538538446704 &
            ,-0.259232046033,0.987746750547,0.608705833894,0.910268982675,0.366802592395,-0.218022222502,-0.365344476902,-0.629465665469,0.802852107765,0.465306540167,0.580784824282,-0.073772641642 &
            ,0.246984433523,0.409899677000,0.851928087149,0.080394357798,-0.243695146001,-1.040959530174,-0.520397030323,0.651165379506,0.174994470754,0.218099091055,-0.341533758578,0.078706056005 &
            ,0.340949556464,0.667545546390,0.708390101273,0.346483041581,-0.204892545271,-0.013315058894,0.133987387694,0.278014223833,0.144290578793,-0.275202027521,-0.144661700906,0.266048789580 &
            ,-0.078649639879,0.366098078719,0.051264869948,0.060957050419,0.151392749216,0.052246117041,-0.026894816976,-0.120076505898,-0.536692299514,0.025847831124,-0.040319840560,0.174200714059 &
            ,-0.401752638280,0.119246137868,-0.289588414415,0.733480969873,-0.090582186480,-0.054973372604,-0.680225101340,-0.686996894424,0.561656212381,1.341785957111,0.505234452903,0.421905183864 &
            ,0.229708226549,0.304986871305,0.378646642732,-0.942894580358,-0.522088677094,-1.973689504570,-1.552776934859,0.264229421223,0.495089096355,0.577890697169,-0.540100047167,-0.428691868410 &
            ,-0.499575847212,-0.543827154741,-0.323285448199,0.037029749426,0.209699068100,-0.065579719892,-0.509784445296,0.099566442309,0.034569163984,-0.296733409272,-0.105430295092,-0.382981838447 &
            ,-0.063131693618,0.001452568852,0.113780435037,0.256635210719,-0.134344163349,-0.071898332471,-0.100760576487,0.171262291676,0.059022268494,0.104826644736,-0.125243175024,0.062902222974 &
            ,0.123469927195,-0.117873537268,0.054851795473,-0.231800017304,-0.060532185423,-0.012887803867,0.104679116338,0.038252740877,-0.155247715405,-0.100168393334,-0.164136700889,-0.049567323731 &
            ,0.139640791050,0.125761867630,-0.033896222194,0.070321661208,0.052778982925,-0.283066144276,-0.150989258633,0.096127040258,0.086364025430,-0.080427721443,-0.001265746821,-0.011605701339 &
            ,-0.184913249657,0.063963519547,0.027286641836,-0.095144600935,0.051328258828,0.124930970724,-0.069231437646,0.056491331566,0.138738414567,-0.177343728223,-0.092014883022,0.107038967947 &
            ,-0.087156900517,-0.025146316026,0.020393051508,-0.000128777244,-0.005500715010,0.154977882307,0.056795234649,-0.112482442403,0.238518581741,0.174817271855,0.137587980523,-0.049827686724 &
            ,0.755339787234,5.689019528187,0.536467961444,0.349269834426,1.667334115843,-0.042637502259,0.924858023661,-4.796277250781,1.221809901377,-1.761210278555,1.873560926067,0.459194916866 &
            ,-1.919827879178,0.382081307838,-0.486674670547,-0.537135166809,0.989535851145,-4.614757818722,-4.195038159516,-0.258751475125,0.558094255193,-0.178604768941,1.368370247661,-0.127483605980 &
            ,1.146870409480,1.258479876691,-1.915098083084,0.734287403555,0.590483852904,-0.083949089850,1.099397658154,-3.769365728111,-3.716727997144,8.715449492078,6.205159413861,-0.634508474831 &
            ,-0.960547538862,0.228694687657,-3.141703750963,-6.989023789763,1.741993102078,9.232899503722,2.174030808630,0.595985110466,-2.472965348301,-0.712865701320,0.332340593968,-5.276520265651 &
            ,-0.068854055794,3.812478951895,1.583924585417,-0.366785574137,-1.928269187537,-0.178112024059,-0.388374084747,-3.513151672322,3.111264099364,-3.641673865897,-1.431948936072,2.067148259698 &
            ,-3.668034100857,-0.263847287220,0.938311919502,-2.066258428442,2.796128552251,4.067158581506,1.217418481359,-3.133905656016,-4.794629753847,-0.137569574318,3.130035281323,-1.106376304612 &
            ,9.194949655636,-0.072931385176,2.494882829826,-5.277928005840,-6.661852873702,0.205450019748,7.064347184921,1.784034659229,6.582417115930,-2.419977769809,0.143401957691,-2.320905109827 &
            ,-0.549772168027,0.525363983885,5.091534610041,0.988769207548,4.200518442678,-0.668477012100,1.077595933618,-2.319122356469,-1.526999867462,-0.001556607219,4.037959641085,0.334437153095 &
            ,3.674031194088,0.269280144385,2.611400136700,-2.654797513154,-3.181008499192,0.001087669482,1.033546756650,0.464430971947,1.756291779437,0.201802145706,2.553322002408,-1.977361093408 &
            ,-4.127670676053,0.543793548435,1.367737195979,0.350648792118,1.450313015403,-0.408722263764,1.025853069192,-1.641014716340,-2.759823273568,-0.764332578508,0.517607852923,0.992785865192 &
            ,1.096178428550,-1.392297376211,0.434940337939,-0.820307944521,-1.602608171472,-1.680739819611,0.012416358193,1.591827414239,0.817700694699,-0.862886100892,0.032500256424,0.759912497780 &
            ,-1.782934717777,2.301012832384,-0.037610326924,1.590671456904,-1.925445195365,0.160958953088,-1.552810868487,1.789156907699,2.677561425836,-0.752089294692,-1.496095079276,-2.837070047206 &
            ,-0.992691244743,0.032395873743,-0.572437635342,0.777334030719,0.303277950453,-0.277242991405,-1.357084913239,-7.018601790920,-0.645341564076,-2.983484084998,-2.009707744127,-0.065784377809 &
            ,0.525478483231,-0.284987727952,-0.930612202389,-5.374087424222,0.445461545022,2.639603087318,1.562222209424,5.413988926702,-1.092624860567,0.210192397114,-1.308132547461,-3.946266969538 &
            ,-2.281686015185,0.256764467273,-0.975422951441,-0.034779039626,0.837802536298,-0.200152485610,-1.233606216940,-6.802014169240,1.922295587651,-5.876979791031,-1.354299209107,2.008284503623 &
            ,-3.173178047050,-0.025361458239,-0.842350796620,-15.611429550037,0.933899634426,-4.312271299261,-1.761379015076,-3.386658464070,-5.099057380093,0.357517458441,1.642072439942,-1.457162043316 &
            ,-0.196776402957,-2.366315340267,-0.522367559918,-0.323332198586,-6.346112141853,0.120829740622,-0.240477072726,-1.965874080052,0.580456597549,0.752959113840,0.307000932153,3.894373377871 &
            ,-10.882314248295,0.127525012466,0.039138102050,2.853868315387,-1.514869949111,0.293042595505,-0.324955054797,2.911644593093,-11.209203419927,-0.075403599590,-1.705129579166,2.609919402987 &
            ,-0.161140898337,0.535820342687,-0.633429215056,4.229262888379,-2.538831367806,-0.033099743471,-1.197230092027,-1.101495962301,-0.378956474343,0.177773127111,-0.128299630522,-0.716665038565 &
            ,0.412751090859,-0.140297679838,0.097759896565,-0.160901473085,-0.947409496698,-0.228223113195,-0.190884895015,0.843351969675,-0.206047976759,-0.078301918578,-1.132240743005,-0.612507861421 &
            ,-0.397020534022,0.576441055581,0.092938188124,1.026270823678,0.161305260362,-0.031734161234,-0.561698594208,-0.822541137885,1.641039748823,-0.108965714644,0.426219685539,2.157404634740 &
            ,0.049925126253,-0.025681759697,0.340585720152,-0.949086458878,0.697030241300,0.471130023262,0.650545972360,0.809172874515,-0.344987062395,-0.003821544525,0.279860876990,0.680141255833 &
            ,0.613517558210,0.663987664336,0.276049784768,-0.537954415924,0.246584871983,0.145538873189,0.781593225796,-0.290821890294,-0.425723780662,-0.130120329322,-0.172824263812,0.572656707167 &
            ,0.256446909202,-0.254528189632,-0.439983936410,0.434755733239,0.448590148013,-1.020449328405,-0.237230859391,1.582344540406,-0.168100931300,-0.228736453164,-0.291884904753,0.155302123463 &
            ,-0.109030285611,0.573108283369,0.847100049286,-0.156033565251,-0.247372281027,0.038954376965,-0.165210866979,0.358780573985,-0.143341538218,-0.042511422825,-0.143999467799,-0.372931788747 &
            ,-0.104376577273,-0.115598759323,0.086962809119,0.909484106252,-0.280556929733,-0.735891929255,-0.815260461285,-0.479646761209,0.342358116709,0.201710288995,0.095891001507,0.622309930057 &
            ,-0.425020895247,0.732219664214,0.589470719141,0.241985104674,0.178645395780,0.092579910759,-0.438656352247,-0.106597576559,0.664206525862,0.683150305924,0.627804637013,-0.743294384897 &
            ,-0.045999891070,-0.196053780171,0.764428566825,0.982077237704,0.133176950351,-0.131987060477,0.040029044832,-0.152592737823,0.203594467421,0.118949271349,0.099540462184,0.318149242296 &
            ,-0.190584540784,0.559836229484,0.515712312911,-0.721193948711,0.400551295703,0.116842961310,0.123376002852,0.747973869785,-0.897788288330,0.720249301214,0.340650430650,-0.726522681254 &
            ,0.959681582871,-0.142122209038,-0.300913051806,0.710865744107,-0.401363936660,-0.496118940376,-0.219821393449,-0.385510402321,1.287452141494,0.117214271985,-0.068102824563,0.371193809485 &
            ,0.226571137960,1.409631450802,1.341681519633,-0.413520165039,1.313739102691,-0.078920807191,0.762814471265,-0.355641562322,0.386444292302,1.009059005366,0.943483345272,0.076601541738 &
            ,0.253674669020,-0.048670485311,0.396103638993,-0.386324598453,0.136894739088,1.251799434809,1.511291684115,-0.048120823055,0.116283888689,-0.052592084738,0.120651609005,-0.393983492252 &
            ,-0.051497971358,-0.209446824407,-0.272589300396,-0.042847362442,0.128281389668,-0.020720441473,0.042011801032,0.071336323190,-0.030003590956,0.563937311547,0.468042210040,-0.205482574983 &
            ,0.111527227004,-0.043662979410,0.101342071257,-0.268831622790,-0.187624463264,0.765688799744,0.886882967151,-0.020759412118,0.104417353380,0.074152791681,-0.095536465989,-0.013820735317 &
            ,0.114845577247,0.091810170720,0.152898075927,0.082564423707,0.099544010009,-0.056588802226,0.106295287862,-0.146361646085,0.088173306182,-0.066916195468,-0.178336747980,-0.045399442534 &
            ,0.084108660541,0.068424343306,0.147257769373,0.088789615676,-0.074867249989,0.947490886567,0.911029342816,0.442833532238,0.105695531353,0.074675406248,-0.173943339944,-0.352932040300 &
            ,0.026613949212,-0.144673040806,-0.055828147519,-0.118433783929,-0.017268182451,0.042842874277,0.068202542280,0.181236471119,-0.044404914109,0.063990910121,0.024252607367,0.165879870881 &
            ,0.021650195345,0.005362240271,-0.104618657294,-0.213804980397,-0.084190929390,0.020875296412,-0.016242694688,0.225884298528,0.021996144130,-0.028371117699,-0.145243251237,-0.170704414557 &
            ,-0.102620321517,0.115338795640,0.002804040942,0.230288728136,0.084135225721,0.000738872670,-0.139502458753,-0.233924914874,0.083870439705,0.044410607211,0.106812405528,-0.271411863125 &
            ,-0.028636693574,-0.035635335034,0.130381953183,-0.111001238848,0.026437253893,-0.013173442473,0.014171692597,0.084963287048,-0.033507277954,0.033609843100,-0.019303060387,-0.037965460541 &
            ,0.064599587960,-0.062194144517,-0.052393054024,-0.021507064195,0.030031600158,0.016981035147,0.059775856620,-0.180073427666,-0.223298261725,-0.000762587653,-0.056667994706,0.234253076485 &
            ,0.062155441469,0.024015346023,-0.230248323676,-0.244635534135,0.022962388138,0.147367096203,0.067526530336,0.046995719147,-0.068615778412,-0.017829689114,0.014592978886,-0.233372380688 &
            ,-0.008392836216,0.177583284197,0.116124449951,-0.035301451002,-0.326372477236,-0.057171705965,-0.028099439220,0.035239086695,-0.009150033067,0.012284071306,0.014963114399,-0.002183655136 &
            ,-0.040668327267,0.005269294589,-0.010441356894,0.039630510599,-0.013613392553,-0.058114926075,-0.041705189887,0.053036291782,-0.018200773926,-0.011820447309,-0.026174750888,0.040990088911 &
            ,-0.022675205864,0.060017616934,0.046695000371,-0.068088189692,0.004997106028,0.029497400395,0.009674549416,-0.004316881905,0.016993696101,-0.036991000013,-0.012415600599,-0.015775572210 &
            ,-0.021466878248,-0.000153376090,0.014995452225,0.034871539022,-0.031858503554,0.032455204882,0.003286440222,-0.065146828096,0.017371514633,-0.016636676716,0.003477183806,-0.008648765053 &
            ,-0.003753041120,0.022891572979,0.022590541859,0.018496022145,-0.026210297426,-0.014155635839,-0.013910086086,0.012953573860,0.021240293453,0.017700327436,0.015470880070,-0.068055014838 &
            ,-0.006579098165,0.000332772574,0.038145473042,0.009068423956,-0.021969103026,-0.003652096977,-0.000916085133,0.019004042168,-0.008116701093,0.020618948762,-0.020278365544,0.044965406173 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-14.0031,3.3039 &
            ,-11.3219,0.79973,13.7869,-10.8224 &
            ,6.1515,0.40293 &
            ,-10.4978,-8.252 &
            ,3.0037,12.7803 &
            ,16.7606,1.649 &
            ,-13.31,-1.4686 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-7.9491,0.83561/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-0.035526,2.4009,2.7359,0.49623,2.5642,0.82769,-0.067996,-0.97273/)
real, dimension(2) :: bias2 = &
  (/-2.1592,-7.6586/)
real, dimension(1) :: bias3 = &
  (/8.0394/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
