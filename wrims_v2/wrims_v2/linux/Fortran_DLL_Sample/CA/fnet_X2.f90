module fnet_X2

! a = 0.016345
! b = -0.67053

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/-0.168194326995,-2.394827190876,-0.044634204736,0.285264838572,1.704193698592,0.378226475691,0.435091477657,0.275820633479,-0.198637731617,-2.043479834200,0.052378172283,-1.478767796269 &
            ,-0.133353608918,-1.265075698224,-0.605565199229,-1.453055114674,0.858638809739,-3.080566127749,-1.187547618396,0.765818714257,0.711878053234,0.252747452133,-0.000970217557,0.954680858091 &
            ,-0.179335489407,-2.346513336940,0.258575149768,1.607627101910,1.470286781004,0.702639410947,1.238289186598,0.562836803054,0.497428522460,-0.850674643155,-0.769696364625,-1.477294697523 &
            ,-3.077215440540,-2.305897986892,-2.572449369357,-1.301030698488,-0.755259719019,3.299444163695,0.923097445458,-0.146159476398,-0.841501527670,-0.975916749191,-1.423340455736,3.017667156424 &
            ,-0.548481364542,3.331217182894,0.555119254079,-1.665721546203,0.124880060515,-0.569989986685,-0.863902093629,5.853521122138,-1.510194616781,1.706353872200,1.463218910833,-1.806595638088 &
            ,1.062570709070,-1.459985565261,-1.040494166915,2.801685636429,1.057236436363,-3.364062897184,-1.127000140084,-0.872088232765,-1.113116970316,0.795804361813,1.290021352185,2.073254041909 &
            ,0.002723767761,-5.215152446609,0.245120498012,3.287735765462,3.687613020486,3.475070924533,4.407784890965,-0.220416138392,-0.421720860439,1.315543991335,0.591728729917,-0.423379533836 &
            ,0.213796509029,0.143499646000,0.396053215524,1.110867102527,0.296436781719,-1.061668869738,-0.291733675373,0.032234222225,-0.477509576093,0.102149169939,0.257020939703,-0.583977132967 &
            ,0.033230333234,-0.437694591182,-0.054824373369,-0.104617359258,-0.116349451013,-0.119769394805,-0.029100790060,-0.256680300253,0.008421473814,-0.289719046105,0.035123467939,0.039269184284 &
            ,-0.358906668037,0.277335758695,0.361173303726,0.392300377449,0.168350703251,-0.544601858462,-0.124420642809,-0.108208180655,-0.249821503788,0.122933787976,0.367921240824,0.170951812651 &
            ,0.079685147134,-0.267988622307,0.029068074237,-0.361537465004,-1.028869010199,0.103970346877,0.487196724087,0.172198417486,-0.018012044317,0.225373459003,-0.058989295918,0.286321591108 &
            ,0.591434124123,0.015909666743,-0.235463668706,0.688754483550,-0.063594785338,-0.521809337865,0.064006459609,-0.792380781386,-1.941166597117,-1.044754639460,-0.622179058065,-1.449842554382 &
            ,-0.341555882478,1.294319524966,0.232753853221,0.113210272321,1.248266073649,0.042888533427,-0.438088081489,1.709530897895,0.163327057831,-2.950984507693,-0.326198884440,0.003900513845 &
            ,-0.930898643240,-0.648386240474,-0.548278336975,0.309814554814,0.705469544169,-1.855850943789,-0.725873594646,-0.064964589091,-1.503157618846,0.228970139628,0.465660245380,-2.872838583970 &
            ,0.404720182403,-0.088020207868,-0.630773561191,-0.047577120801,2.042986771974,-1.348920556309,-1.313514992118,-0.354626183412,0.089144026746,-2.508334036339,0.039215952472,0.660661768924 &
            ,0.054189200428,1.794313123769,2.232950136352,4.615355010285,0.060064012194,2.439551557826,0.048470970412,-1.627613435831,-2.751064870386,-0.954131265373,-0.867905180484,0.504092932118 &
            ,-0.065202877823,1.243330992731,-0.085159164682,1.194807026068,1.917985696560,0.061202248839,-0.679262708099,2.306411457319,-0.585732405914,0.329280384423,0.501080388018,1.584516624780 &
            ,1.497218328451,1.197919244165,0.356835014298,4.597499938541,-0.041901554431,1.877696755496,0.475554613778,-1.296852460153,-1.972584479148,1.004553499783,2.057656386797,0.120957857816 &
            ,-1.326539823165,0.175927441145,0.967182179204,1.035948930483,2.324809976495,-1.577065926895,-2.371576666205,7.533393976853,0.872524174537,-1.371324884392,-0.879602603656,-1.446379334471 &
            ,-1.163400240197,0.406841382210,1.039773949951,1.524603021171,0.026373122201,1.448634562665,0.335792772624,-0.378322833529,-0.516262291006,1.051900427282,1.514466774698,-0.307544973114 &
            ,0.060818736263,-0.488774484222,-0.024595202757,0.717735210714,0.332466625976,0.715948619449,0.697738170963,-0.475178178590,0.343895490301,0.120080822816,-0.314684472334,0.003816714066 &
            ,-1.263511343828,0.041759732693,-0.137529941916,0.211050787609,-0.079261209384,-0.001810508916,-0.010369703409,-0.251700345694,0.749999047777,-0.460370708701,-0.389657441217,0.293187507489 &
            ,0.432313291811,-0.123269789883,-0.661557751585,0.466084657889,0.211535244569,-0.436735393115,-1.183009695094,0.042358342332,0.149940285456,-0.809811304218,-0.119488207034,0.560929696213 &
            ,1.422215094943,0.724525641982,0.934835783067,-1.492779794771,0.171271094710,-0.929578547586,-0.145865393698,0.845247255641,-0.306957076206,2.455452255496,2.064481247923,-2.180226842905 &
            ,0.040591865685,1.342519747415,-0.643145525017,1.100411980409,1.404591262596,-0.281579234718,-2.292225859904,0.154552947815,-0.118042794156,3.276198906536,0.757855866967,-0.504380819881 &
            ,0.364347778301,1.069293445558,2.789416638160,-0.347955163279,0.120669453217,2.090261027304,-0.174154593104,-1.131032523172,-1.751774119580,-0.397085416668,-0.446932009173,-0.574953446299 &
            ,0.577963374283,4.342708214850,-1.495122367182,1.199133291608,0.661633266360,-1.408833165408,-4.416166115759,7.041293303581,-0.032209690139,3.448835741040,0.466685238926,-0.512413576260 &
            ,0.539181395243,2.867774856187,3.865966298703,5.833882638798,1.524681816428,-2.987698920548,-1.724765632441,-1.396143627123,-2.345737785265,-1.056296286603,0.163036305634,-5.854276233725 &
            ,3.830929413317,1.635377603055,-3.618265898630,1.502677135976,3.903278743056,2.142667105590,2.243874628629,-0.159376978082,4.177887198194,0.677780540389,-3.126628859273,-0.611672606520 &
            ,-2.568346251085,3.707057919166,4.074365180429,0.991186755556,6.553032517603,-3.967202384518,-6.612262424620,0.489222694273,2.529371629714,-7.683581575830,-7.765997259292,-4.163758595209 &
            ,6.151963593961,-4.472223698708,-4.069282035980,-2.205381060062,0.841227379283,-2.350178075072,-1.256914056197,0.029388572118,1.251144819002,-1.458908729352,-0.787781308546,-0.633236559011 &
            ,-0.182013114428,1.268375205100,1.640290069693,-0.393603286990,0.517993730194,-0.854347347997,-0.190468344137,-0.280418748324,1.035315949268,1.498300707285,1.794663319892,-0.863363145369 &
            ,1.634153988243,0.568590733054,-0.984923921473,-0.609397876766,1.410834547047,0.556769753639,1.395707785755,-1.476268067698,1.498520509199,1.175511811539,-1.429605561617,-1.014114899357 &
            ,1.139566786404,0.956963699732,0.133274149854,-0.340106362886,2.429690998052,2.001307436269,-2.150676921285,-0.977700098985,0.927725090442,3.311115508917,2.632460872308,-1.359518963089 &
            ,4.179589328849,2.081150339991,-3.741194753472,-1.696003872506,0.699298872141,2.191472117208,2.539955141739,-0.322266019575,-0.092996386889,-0.263520608567,0.194598751405,-1.931169106938 &
            ,0.438102049702,-1.230232851726,-1.137567717979,0.424042856988,-0.857748098422,-0.450310584227,0.500371152607,-1.328042392350,1.722130689879,-2.597066942089,-3.079930650840,0.658598894794 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.942,5.5867 &
            ,-0.7517,-0.73915,-3.1277,6.3399 &
            ,-5.0892,-4.9479 &
            ,2.2577,2.2496 &
            ,5.2907,4.6951 &
            ,-4.7529,-4.1641 &
            ,-3.1183,-2.4666 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/3.6625,-5.6523/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-3.0283,4.7467,1.7743,4.4533,-5.1435,-0.65425,-2.3207,-7.7056/)
real, dimension(2) :: bias2 = &
  (/5.3189,1.3983/)
real, dimension(1) :: bias3 = &
  (/2.0902/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 54
    inarray2(i) = inarray(55-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
