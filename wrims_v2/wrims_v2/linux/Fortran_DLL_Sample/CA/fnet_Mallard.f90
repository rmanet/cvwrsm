module fnet_Mallard

! a = 5.0569e-005
! b = 0.091057

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.852548057603,0.003057065521,1.460759634111,-0.287388806630,-0.620246934004,-1.686715263213,-0.097763679930,-0.781407008661,1.440644424972,1.038499291520,-0.201818401455,-3.293761786778 &
            ,-0.683174825173,-3.502224507178,1.121783423352,-3.056799498326,-0.226573944203,-0.245155145358,-1.038840980463,1.095628156397,0.109077660246,0.271900576947,0.021069818817,0.547329425206 &
            ,-0.677376303449,0.303591593790,-2.448175200734,-3.002988321381,0.597577130873,-1.184070102681,0.151226610865,-2.063752764987,0.471677981389,0.432932458441,-0.301560727968,1.342463324597 &
            ,-0.258620157846,0.547714945393,0.144761894034,0.888187231422,0.658875544626,-0.947052367783,5.121539541079,1.227591999400,-0.797231774737,0.677239415668,-0.347552807656,1.400087835502 &
            ,-0.709771431973,0.096917538904,-0.935721521806,-2.183365705133,0.608577623704,-0.363015705296,0.356156175274,-1.260678935722,-0.238565484293,0.247114660842,-1.258955602259,1.963706774674 &
            ,0.174100815297,1.939025346241,-1.182700235106,1.452625413168,-1.192260364094,-0.921618633464,-0.945576423183,2.146810925730,0.543019962877,3.340605451878,-0.340887094901,2.584811954897 &
            ,0.976663750241,-0.023301226787,1.283864988760,0.580532009450,-0.717027884452,-1.190013708825,0.655406185596,0.054885985228,-0.118639607766,-0.158277026401,0.298667810459,0.415267040372 &
            ,0.012244355409,0.559516340532,-0.315681512876,0.497097958714,0.349355207522,0.231629881924,0.244629947242,0.003298229024,-0.184116353811,-0.286531713064,-0.093052669059,-0.137933691753 &
            ,0.061281606503,0.146292510999,0.234819903997,-0.342979529630,-0.027563893193,-0.062439313131,-0.052329250984,-0.168888920072,0.506819912399,0.238661693820,-0.077895220007,0.167141777491 &
            ,-0.311356557947,-0.423600530967,-0.092902260693,-0.141755471892,-0.146813943100,0.052560743995,0.056480480231,-0.055287443326,0.092096212949,0.209956246941,-0.211975882175,0.101081565096 &
            ,-0.237285981327,0.188950021306,-0.587376470870,-0.645624554046,0.246102765198,-0.200061942098,0.119003537585,-0.512910504014,-0.969226563685,-0.172194493937,-0.425687812282,0.365683821564 &
            ,0.676529419320,1.426339746276,0.054356690929,0.787273445942,-0.010892347704,0.054866096404,0.139732940542,-0.082557353624,0.015837147468,-0.052227847371,-0.248300573129,-0.140846034402 &
            ,1.306547178449,0.069714554748,-2.352792860489,1.134320724857,-1.025068721057,-0.894754515784,0.102828397596,0.573810277544,0.720319214688,0.892428099257,-2.152672959735,-2.762946410834 &
            ,-0.172800847510,-2.272277514610,0.040773405015,-2.945843808738,-0.593894751500,0.282492861277,2.116522216204,-0.224936431696,0.511122372360,-0.329727639325,-0.760421165589,-0.508798733353 &
            ,-2.034163542245,-0.736959515161,0.206077633748,0.408891435383,1.174337186104,4.958118501718,-0.412283149741,2.778624328263,-0.532937295775,-0.027741872949,0.025340020032,1.721976192082 &
            ,0.338881469464,1.434898273579,0.251085315984,1.645769810815,-1.343682017547,0.105854681491,-5.078894054762,-0.515654159269,0.935412036399,3.670050221534,-1.363148667951,1.197630417172 &
            ,1.563869576102,0.891660816309,-0.815781500275,-1.172347606643,-0.775858277527,-3.878560330555,0.988683405991,-2.279488476252,-1.870959897981,0.180997604811,-1.693059215070,1.775788462151 &
            ,1.462862988731,1.818321709708,-0.785828486021,0.992846823979,1.132376942534,-1.057913417003,1.032786574257,-1.939814449259,-1.155319046564,-2.075990095034,-1.151460967656,-1.711646971599 &
            ,0.448515973467,-0.238210820479,0.576966411915,-4.751688465590,-0.269013937253,-3.382938974481,0.675263837549,-3.427564282770,1.314057626705,0.118210154055,0.548735034451,-0.910560764478 &
            ,-0.844908024491,-2.387626519500,0.731433022603,-1.411063192680,0.806127484373,0.239993387724,0.219144017239,-1.038579452804,-0.518201939696,-1.357146815303,0.084598592482,-0.967065853421 &
            ,-0.176148483261,0.062389451246,0.360758697469,0.500053776253,0.175056646508,0.742681355304,0.139966650635,0.623358813206,-0.284707285002,0.058733763106,-1.567215840888,0.278110735095 &
            ,0.254295999435,0.229480557313,0.345570699876,0.107401455921,0.126643330615,-0.162373195176,0.187755608369,0.990141361140,-0.130647847575,0.762029738307,0.061783458235,0.859215464803 &
            ,-0.463074212491,0.023371215899,-0.540217585718,1.988017351392,0.346434599089,2.198567222082,-0.379597472704,1.842815458136,0.224697676375,0.241752299888,-0.353183263230,0.938490752289 &
            ,-0.066512015159,0.593877803168,0.052015788351,0.662720756920,0.028889721118,-0.343227247000,0.732002316341,1.028810580058,-0.112349422025,0.544548831587,0.613850812754,0.933426607422 &
            ,1.032530471399,0.119833217846,-1.415407630961,-1.694058913186,-0.717878239975,-1.681853194316,-0.110931550838,-1.633083494450,0.459293358978,0.009182541124,-0.241195517749,-1.041942512126 &
            ,-0.347703249831,-1.496158258058,0.243733776496,-1.045813433123,2.071018526566,0.011775442164,1.282538676752,-1.585815178610,-1.407436632827,-2.681584364445,1.200418713717,-1.760973217039 &
            ,0.394589407962,-0.154277628762,0.068181542368,0.705612071238,-0.085696893604,-1.661074364123,2.100879472013,-0.291939173179,3.350976869519,0.957462554646,2.678099427062,-2.031269207120 &
            ,-2.050617574487,-5.010551633910,1.772697723379,-2.804831579208,1.282331037155,1.076525331167,-0.210481447758,0.365244040886,-0.599455613315,-2.346529707237,1.187716601016,-0.669533882967 &
            ,3.364646982385,1.668801015693,-1.551146225792,-3.425162853962,-2.017912446392,-5.706655196845,0.413158270569,-4.101687142865,0.211124906705,0.961651203676,-4.333128947872,-3.173913368221 &
            ,0.118727958622,-3.220851214949,-0.039297944731,-3.168990305905,1.530308251047,-0.060837064514,-0.394187865184,-2.086577009659,-1.317611429692,-0.972472218538,-0.431135821177,-0.969880857948 &
            ,-2.148219491952,-1.320187207408,-3.185065579873,2.457991366905,1.108111179481,4.187347528581,-0.560477809804,3.161172092793,0.153475829840,0.132267307373,-0.330801774313,0.035592364798 &
            ,-0.105155643362,-0.225410165396,-0.000044777212,-0.030940635143,0.062413080690,-0.225465232311,0.268017564282,0.215407230469,-0.123386793776,0.324204960382,-0.097413107012,0.322091356195 &
            ,-0.463887310194,-0.150192367285,-0.314427651090,0.403810513822,0.294910992321,0.491801535327,-0.215148692393,0.283778995908,-0.406222447332,-0.288595897817,-0.105683492247,0.172005513828 &
            ,0.195844951953,0.875083082874,-0.117443038352,0.578285198645,0.109299058715,-0.065842666439,-0.196310325854,-0.261505151096,-0.083148228078,-0.184792289293,0.171955221963,-0.200681295951 &
            ,0.201178543005,-0.226403268848,0.120159668107,0.282449678134,-0.196229540272,-0.072545768324,0.170917303822,0.184730617806,-0.235338329651,-0.130664346096,0.132197155129,0.538545550029 &
            ,0.110266008076,0.724165991354,-0.129057356854,0.641534835142,-0.223923389614,-0.064854872566,-1.262654335860,-0.836042037157,0.230278408805,-0.475217225918,0.332121274901,-0.715819522078 &
            ,-1.179114802504,-0.099731834100,2.115168007785,1.217007132720,1.080459449988,-4.723874044931,0.047776412382,-3.719863310720,3.846177646263,-0.945059428946,-0.818488877937,-4.734176079610 &
            ,-3.289294550771,-4.699799438305,0.888901919791,-2.402457329675,2.489052279905,1.564984433864,3.184488093783,-0.857714009102,-1.306244860213,-1.564311458876,2.765668633263,-0.046059254751 &
            ,-3.777412631650,-3.975121296238,4.369433166381,-1.854769749375,1.603033513130,2.094626590779,-1.758002142540,0.173133706747,0.510657146822,2.768351624764,-4.077243025002,1.394946893330 &
            ,0.478582506281,-0.721375400235,1.279129608974,-1.016807931101,-1.716124071262,0.729807203501,2.965085233508,-0.415103761856,1.473376036121,2.748575459726,1.017293707189,1.628841659369 &
            ,1.449471350578,-1.241675372152,-1.792372194470,-2.219927407906,-1.445287196993,3.657035823412,0.966859908312,1.709076872515,1.156901541238,3.464464844957,-0.704432385528,-0.584434299961 &
            ,-0.024507589922,-1.318001688799,0.184119499678,-1.094583063383,-0.661821624297,-2.016953612475,-3.128685201434,0.810378561113,-0.080439033071,-0.838111914941,3.182950342441,-0.960631659969 &
            ,-1.954140083412,0.168085728194,-4.704645672071,1.236196507916,1.159769019604,-2.731928437335,1.368627928471,-2.497329691536,-0.340789626862,0.954894431423,-0.023226610858,-2.123551049217 &
            ,0.335250206874,0.713580484248,-1.478512734464,0.525108079637,-0.195917341796,-0.132467849533,-0.286661188854,-0.085538905042,0.202783062104,1.002971011990,0.040378770507,-1.290913940613 &
            ,-0.607433951625,0.703063211131,0.471895644514,1.059236258807,0.627968035333,-0.168964072585,-0.256400837836,-1.352113296624,-0.689695622395,0.876207691091,0.972120616290,1.466663063482 &
            ,0.809164766795,-1.056171441207,-1.248703818383,-0.556933454400,0.439605957894,1.338311433918,0.865621772285,0.787388847738,-0.444966836144,-0.866412701665,-1.053513782223,1.375014347973 &
            ,2.016931851834,1.560430298090,0.906887241361,0.633904117557,-0.670005164467,0.713555324107,0.822961582830,0.919712309032,1.398066573264,0.806979472872,0.908200629115,0.351521329137 &
            ,-1.366879117528,1.113119961553,1.493589426273,1.269634164179,1.881771360596,0.670236176619,1.126799772719,-3.401767450103,-1.283901416470,3.576117794627,-0.029628239131,2.776187439963 &
            ,-1.548512741135,-0.038699301007,-2.513187894912,3.519269278785,0.996619517909,3.117679999261,-1.615662855314,2.712988604423,-0.546038599402,0.941031032139,-0.751622032504,0.548581723872 &
            ,0.730271107882,-0.198532938068,1.617632030862,0.382975816459,-1.057428010047,0.341338007548,0.122753250423,0.672532363280,1.221966005880,1.514101825829,3.261280664699,0.036318912308 &
            ,-0.993403944714,0.000137296117,-1.906564386653,-3.106077138778,0.525598117617,-0.289704396393,-1.094564570702,-1.520324438112,-0.260046471215,-0.693953045469,0.214073760862,1.669355849310 &
            ,0.248072058784,0.373791546214,6.224925216852,1.508500795232,-0.683299566410,-1.442268080275,0.420410860502,0.505233288343,0.033571420622,3.175045383046,5.028177747819,1.827009707513 &
            ,1.406233094064,-0.154690373772,4.672907952004,2.233904440827,-1.227677811325,1.213000664312,2.814513224373,2.269363590295,-2.151903208576,-0.075967085032,-2.442846166111,-0.870554291086 &
            ,1.447621160210,-0.812543579869,12.440119116286,0.605765423618,-3.755810090998,2.650405277915,-7.336380219404,-2.023178612483,2.852820844135,3.738775101652,6.318886718551,0.016966387578 &
            ,-3.665173802561,5.306970794805,-2.120950047942,1.369767983609,2.514659534662,2.833326007446,4.453914805572,1.297754165704,-0.940854516720,0.035355582487,0.997592576601,0.620824845574 &
            ,0.195554690255,-0.340486201013,-0.989922840460,-0.155316445622,0.700604338682,-0.157482896555,2.836737753148,-0.584071679348,-0.842129254659,-0.205964075049,-0.329178155486,-0.403211048721 &
            ,-0.211196012297,0.857862053496,4.308546594882,-1.015356746095,-0.011460292098,-1.306842761305,-0.599548595362,-1.095377901280,0.551178162376,1.730476415159,4.776954746643,-0.514278727403 &
            ,-0.224334858703,0.580580926297,-1.087459252353,0.155164200652,-0.303973631250,1.155333452120,3.444038945914,-0.445985467061,0.141253314647,1.484632219346,-1.768468628069,0.268816780055 &
            ,-1.176383732479,0.773962103240,4.694202458512,-1.090366516709,0.501306104083,0.901147624923,-2.131416731943,-0.205633694803,-1.049855160687,-0.605531173007,0.050496447588,-0.023252085031 &
            ,0.195074373255,1.026402435265,-1.609651672922,0.254987607928,0.570361995211,1.750052217190,0.407048990027,-0.237978907044,-0.095494955558,0.391963284908,1.168245635887,0.577949966627 &
            ,0.064876404545,-0.058613932592,0.500154675455,-0.316882133312,-0.046411731538,-0.003460892174,0.135092819353,-0.117844726857,-0.070705856610,-0.006323840811,0.129230591112,0.355348147659 &
            ,0.034769114038,0.252302741033,0.010602893558,0.357581967904,0.113477162552,-0.181101100582,-0.048227479417,-0.868986713581,-0.163812766577,-0.599783593723,-0.354412416018,-0.653662486977 &
            ,-0.228789434822,0.033034695369,-0.214688023128,0.848144327368,0.223950460133,0.741517327723,0.315606092446,0.680939177283,-0.014650823130,0.087369083855,-0.042866314216,-0.158162456958 &
            ,-0.011332162611,-0.177486416244,-0.686873509185,-0.228985783243,0.358920747780,0.320572272385,0.023731618050,-0.337335565954,-0.167225858358,-0.623873388072,-0.384887248788,-0.485999077141 &
            ,-0.272318673524,-0.211621705226,-0.066620542358,0.704411265726,0.104303588031,0.816826201630,-0.411563677814,0.759102283468,0.076904468272,-0.145623256741,0.331326888461,-0.264784597563 &
            ,-0.045942158079,-0.206092736578,-0.354163748856,-0.263140705788,0.198746060428,0.219111181633,-0.403788413893,-0.310696615353,-0.022163097437,-0.608178538810,-0.485392165334,-0.571605826006 &
            ,0.240922878129,-0.503500474612,0.229935980707,-0.268829517978,-0.216160494000,-0.034816091790,-0.065324212761,0.017144766528,0.002378039838,0.088279643312,-0.432507270707,-0.020414034814 &
            ,0.050861918666,0.098385109350,0.012298658974,0.009870267218,0.115354374135,-0.108829075469,0.240775812027,-0.180165363342,-0.089538631047,-0.151171991371,0.055978177529,-0.119328992359 &
            ,-0.146348094706,-0.039963349059,-0.584682729434,0.125587145640,0.119717800391,0.131727844948,-0.005524716342,0.073348074940,-0.415496989587,-0.263243583243,0.057359544149,0.265535162702 &
            ,0.241761621167,0.781047099247,0.021208209084,0.518664773498,0.075061466967,-0.181478155126,-0.014243985824,0.020598127923,-0.084791176526,-0.131939337156,0.203151248272,0.045611595370 &
            ,0.323550925529,-0.043014989442,-0.051990297146,-0.267357741449,-0.202126488987,-0.617180292085,0.258983553302,-0.362615056077,-0.045944045923,-0.034106372863,-0.205417405916,0.214893259389 &
            ,0.049881164450,0.045442983274,-0.018717232756,0.074608087243,0.045779326181,-0.089745724455,-0.067868179914,-0.183298406131,-0.066120554487,-0.096562762267,-0.074072487078,-0.096415108202 &
            ,0.019474929676,0.040243573868,-0.081037866502,0.010274219808,-0.007412939000,0.019343936505,-0.054280097764,0.009385862615,-0.075489349146,-0.079228047196,0.050441521826,0.260107869669 &
            ,0.024454275942,0.193120087892,-0.025869449824,0.222333029929,0.023848026559,0.029565383969,0.109719586529,-0.135312067529,0.004661445158,-0.111953815165,0.082212209297,-0.122715677965 &
            ,0.014005579365,0.021590574153,-0.092269430552,0.255819125056,-0.013609584743,0.118784140930,-0.067591518401,0.170206621554,0.005912956186,0.004421840450,0.001194902771,-0.322844497315 &
            ,-0.003238146741,-0.080235731936,-0.010429116282,-0.175051145838,-0.069222800462,-0.019814106445,0.018033844204,0.115829424953,0.047052799980,0.048814230367,0.006978320572,0.062044990542 &
            ,-0.049787116589,0.004577542646,-0.119827890886,0.028416926603,0.038175172948,0.113976651118,-0.024571081772,0.045903414181,0.152991583632,0.014807389253,0.216649293072,-0.115707320307 &
            ,-0.103455146984,-0.255892289982,0.070350467357,-0.148081162920,-0.121199912773,0.012074833717,-0.269581452345,0.182028801308,0.091058107818,0.243081107567,-0.054326800326,0.169572754695 &
            ,0.063695406344,0.006741668236,0.148458005167,-0.073597856970,-0.046009140757,-0.124703700852,0.037868363349,-0.063688160629,-0.016856266793,0.052566052824,-0.179660853281,-0.003343784723 &
            ,0.023545570830,0.022830620605,-0.073081449293,-0.018436573372,0.042484396445,0.018498679317,0.014597012044,-0.042759681928,-0.021533062058,-0.144566971108,0.043549059671,-0.088788075995 &
            ,0.038953444842,0.010529588907,0.060840050105,0.005537445660,-0.025194052789,-0.039255055876,0.000528715778,-0.008479174360,0.028912298198,-0.052657768927,0.091325209854,0.006756284785 &
            ,-0.034240694041,-0.055534455087,0.060108712396,0.006474319493,0.003926472636,-0.009193189089,0.046451608117,-0.166036406867,-0.001103188896,-0.059761242336,0.028408943223,-0.105426147692 &
            ,-0.032319673979,0.000704244395,0.065038222425,0.050806012866,0.018209498739,0.115574894722,-0.060189466215,0.078532206244,0.092156912730,0.028044893188,0.076887161882,-0.031793500688 &
            ,-0.056515318659,-0.119222422219,0.043629105315,-0.056112933529,-0.093771798442,0.011308982190,-0.117825304214,0.097497362323,0.071779236147,0.199718908939,-0.051830345078,0.110221481327 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.4468,-7.4433 &
            ,5.886,6.9958,7.6617,6.2537 &
            ,-4.0188,5.3051 &
            ,4.2074,-5.1609 &
            ,-1.1352,4.5383 &
            ,7.1466,7.0349 &
            ,3.3616,-9.261 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/7.7151,-9.0529/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-4.357,-4.6993,5.0967,3.9542,1.9422,3.2663,-4.1972,2.3993/)
real, dimension(2) :: bias2 = &
  (/-6.7868,-1.3362/)
real, dimension(1) :: bias3 = &
  (/1.4403/)
contains
subroutine fnet_Mallard_initall()
end subroutine fnet_Mallard_initall
subroutine fnet_Mallard_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Mallard_engine
end module fnet_Mallard
