module fnet_CVP_intake

! a = 0.00068668
! b = 0.1

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.625055290192,-0.457038672681,0.319151574559,7.803501253336,0.336986014925,0.267759151924,-0.024526147747,-0.498275806469,-0.591488289348,-0.152856521119,0.160151340202,3.798346361225 &
            ,-0.831305159770,0.101166327772,-0.008248428382,1.637145819910,-1.029552621491,-0.764409537811,0.401641162255,-5.041260564052,-1.380172790654,-1.322378253575,-0.003834203856,-1.827131706392 &
            ,0.651577931096,-0.060587972071,-0.482204406431,-1.736382935507,0.382082008579,0.227794697261,-0.003161621929,-1.882416583530,0.558812474378,2.185385966784,-0.233619808928,2.120231561749 &
            ,-0.925132911822,-0.703266707932,0.026799331741,-0.101144450409,0.211195697498,2.483130263866,-0.488230549467,-0.683231355858,-2.747709424127,1.521559383063,-0.058481296671,-1.015915389672 &
            ,0.784425584924,1.389876694992,-0.200684237667,-3.128288775466,-1.195477854794,0.255560870023,-0.016346993009,0.239990720951,0.146555546537,1.473992368878,-0.526962867010,-4.753577533910 &
            ,-2.042546694976,0.651733241499,-0.012010979572,0.854856442507,-0.827034602583,-0.717262943010,1.153146359932,-1.620349965629,2.184234859195,-0.926781582558,0.000193959739,0.181072066442 &
            ,-1.664196230050,-0.431329325873,1.584477648190,4.337358374567,1.218402956039,-1.449075424732,-0.033097755530,-1.832930997911,0.329187222693,-0.229279949004,-0.357840119671,0.960699531031 &
            ,0.731767041845,0.220886709764,-0.033425784151,-0.481441508185,0.391291382056,-0.312716266487,-0.590281497829,0.161825026997,1.210590674618,0.504093834702,-0.042108419372,-0.481308948372 &
            ,0.522160818027,-0.706799614948,-0.228720907489,0.422487134310,2.032658340858,-0.358355996097,-0.006273609806,0.133933503032,-1.176307400729,-1.181054534806,0.464667215104,-0.961019001644 &
            ,1.472000486941,1.601233021912,-0.106886815210,-0.562483228099,-1.490933972908,0.437130275545,-0.170391339315,-2.112380923710,2.572621822887,2.432439121564,-0.131982577337,0.204339205353 &
            ,-1.646316171869,-1.641120701082,-0.114315019496,-1.872399932332,3.261714497651,2.908264803091,-0.143325158611,0.226398427865,-0.390754726829,0.382911808566,-0.086199060001,0.233945421934 &
            ,1.781449899669,0.855443145142,-0.028001000977,0.658568200013,0.289553848863,-1.286125256443,0.001964475391,-0.041501755315,2.078001842326,-0.925350492209,-0.005331075378,-0.560503587286 &
            ,0.095901872347,0.737113630918,0.059955675947,2.377949068996,1.174684805987,1.944314807263,-0.009366327780,1.062151987238,1.038938007661,-1.746548328302,-0.201975829731,-0.392430865838 &
            ,-2.487735059724,0.199535739773,-0.004227471429,-0.600814737515,0.853046212144,-0.805142865147,-0.615009836688,-2.649014751163,0.791855056455,1.355274789761,-0.015707769069,-0.373422032097 &
            ,0.590364257867,-0.060104791815,0.043370176591,-0.851676037164,-6.051611222189,-0.527070375982,-0.004430263228,-2.564797960155,-0.990340301485,1.855054708636,0.428104127575,1.702266269555 &
            ,-3.558054277949,-0.517641851929,-0.017884053938,0.001465449612,-1.938218821123,-0.485295164232,2.048545959130,0.811323088393,-1.935206956831,-0.992861595872,0.003573427308,-1.599997176539 &
            ,-0.942016197530,2.697039184026,1.786406344640,-1.042560589336,-0.988487823162,-0.207140145297,0.000058220727,-0.324260696607,0.264976402708,7.435889496509,1.334833442024,0.754280541448 &
            ,-3.533180524790,0.378039517896,-0.014249015113,-1.883912286016,0.297660152621,2.621009030751,0.738597343421,0.024956909278,-1.016160494906,1.321070183609,-0.018279900115,-0.332845046410 &
            ,-0.965456716844,1.207995600802,1.391249206924,-2.121355379162,0.394551616632,-0.315803913157,0.006418768627,0.656171034448,-0.079001455855,0.324882109307,0.121697345654,0.267033359068 &
            ,0.097792380311,-0.245648906534,0.011395707045,0.209035096328,-0.152984429217,-0.135318151287,0.114571802959,-0.572679042719,0.479212267116,0.100245674281,0.000026169884,0.292907219505 &
            ,-0.407242748266,0.770546048101,0.374153265493,0.426101464053,0.576251034040,0.217331666368,-0.002076117770,0.302793993721,0.334577427278,0.279435001056,-0.243797753885,-0.006768925073 &
            ,0.772452056141,-0.197909398785,0.020918617656,0.276216123727,-0.387352625190,0.694950780924,0.380496585403,0.230607761087,-0.089720752199,-0.016082417112,-0.004899465748,-0.150287899811 &
            ,-0.373240699033,0.611024329447,0.072254819312,-0.084682898217,-0.049618351462,-0.131837345675,0.016159867020,-0.254423228740,-0.322967676850,-0.029003134906,0.402615814050,-0.049166312948 &
            ,0.867719503506,-0.323145573827,0.019075022263,0.099688151463,0.215185157206,0.207151878507,-0.417379108612,2.531408196976,1.338661823001,-0.352022356473,0.011638418774,0.431460166179 &
            ,-1.242102619538,0.844637412427,0.322439364914,4.809021512910,1.075022170125,-0.714278127304,-0.061264668046,2.564068527620,-0.334602549153,1.132780885802,0.426504049053,3.439029235807 &
            ,0.292673075198,-0.607861927904,0.003353967384,0.745499988918,-1.664703747751,1.280272940172,1.136221010079,8.721172507023,1.653258747729,-1.827032958819,-0.030931951127,2.162317968828 &
            ,-0.311054187507,-0.227242199646,0.137621900734,10.237288037715,0.784441167229,0.340067821104,0.010277426807,1.785531432682,-0.365832024071,-1.456856655937,-0.174844854594,9.658520714410 &
            ,0.433541321988,-0.426401919602,-0.000653630983,-0.214148741122,1.126202649303,-3.075460606760,-1.210161725364,4.998332088648,2.073915964213,2.158425962891,0.028434182924,-0.542477978748 &
            ,-0.017307136536,-3.855015853183,-0.978922691992,2.376401740201,2.995000523740,1.556561222616,-0.057545714811,1.293436766863,0.426832691208,-3.411616620828,-1.061510278086,-2.431404520844 &
            ,2.912124769417,3.283770925615,-0.034479370432,-0.654531634684,-1.802508684104,0.587620095437,1.493938534661,-10.949682851453,4.755437237248,0.588205442723,-0.075726261422,1.178622376241 &
            ,-1.253488769422,2.412291391160,1.345845254823,-11.030476400651,5.856848955928,1.267741518453,-0.059172371129,3.362257398413,0.123430110325,0.083942496866,0.080705746143,-0.728536071846 &
            ,0.480579265937,-0.159131499752,0.006071583756,0.164951448059,-0.117499563600,0.687238451296,0.141553462730,-0.878531196114,-0.064112407005,-0.065139016608,-0.005783157421,0.065143478443 &
            ,-0.006965065467,0.429848924655,0.033033143105,-0.916903408023,-0.139242159077,0.082599576642,-0.004671237312,0.166084620973,-0.058541199989,0.072723820040,0.186282008455,-1.604019387271 &
            ,0.342072639030,-0.097867805829,0.002558559958,-0.158209172346,-0.167855070411,0.476262108907,0.140974215518,-0.451864125835,0.328473642684,0.022702688715,-0.011210329641,0.242658269174 &
            ,0.042904576229,0.420790956449,-0.022780075069,-0.636297198302,0.317298688373,-0.126851546132,0.005026035016,0.211692507241,-0.109938317101,-0.202655865841,0.070322626053,-0.297084831730 &
            ,-0.065882157952,0.098359108924,-0.010114089162,-0.197442145788,-0.104283459595,0.329435683221,0.076521474097,-0.818465288469,-0.109237381666,-0.061665642246,-0.002201582617,-0.062921284827 &
            ,-2.593290596256,3.464004116309,0.466677192986,0.868936431092,-1.627417373601,0.575671912092,-0.033522714035,1.804007283238,-0.568706911682,0.234844960331,0.185565921137,1.162375473278 &
            ,2.954465048122,-0.370052202792,-0.005120129976,0.615744393243,-0.870010953183,1.045987559763,-1.099617750186,1.067965109575,5.231382917592,1.186058168626,-0.006842526396,0.937006015843 &
            ,2.589601243059,-1.302529657133,-0.819921511622,1.189548105704,3.966610930374,-1.544700665975,0.017286527014,-0.511243776908,6.124800718906,-3.747151971167,-4.305149089499,2.769530563973 &
            ,0.939182941442,0.116173569787,0.059629471809,-2.718497857696,4.466149192473,0.267623320380,-7.367162499076,0.408305342120,-1.592756236206,0.229058808589,-0.014271451566,-0.681807326064 &
            ,3.023420160212,1.318764485392,-4.650107047538,4.594605416452,0.107115917565,-0.352305757674,-0.025460247312,0.682094439891,0.550856994559,-3.230857500266,-6.129245807769,5.852575119768 &
            ,-2.774764257947,-1.941398258704,-0.006329485193,1.131630361631,-2.328998642806,-3.316844794953,-6.879883375658,-0.612129149803,-1.316116623141,-2.149609638435,-0.054206313601,1.300619324906 &
            ,-0.614013385557,-1.933950262899,-5.143267969336,-3.696523362444,-0.956517635695,-2.547497841241,-0.028272717670,-1.456911603844,0.709593556167,0.530897512937,-1.270620742113,-0.605033995507 &
            ,-0.080630924092,-1.690344009949,0.006502972455,-0.187761178209,1.331377664364,-0.438281490491,-0.382948841363,0.412075849278,-1.184898273762,-0.998844862232,-0.191460949170,-0.367818435044 &
            ,1.416422777942,0.191909666591,-0.707368902347,0.255016199576,-0.949377180092,-0.675964429820,0.298530244479,-0.983399500810,2.082979166035,-0.128980087376,-1.593804821355,-0.345872429442 &
            ,-0.841231538677,-0.679600680697,-0.286607512417,-0.360816743021,3.081901973944,-0.117205132667,-2.438840551428,0.362513759806,-0.729917303578,-1.069873730374,0.200762918516,-0.483034283924 &
            ,3.348891792187,-0.449392355290,-2.967000331153,0.754663273560,-0.741893638309,-0.414369963841,0.167090928501,-0.378932227016,2.656766037558,0.529649604055,-2.740965018879,0.834188169273 &
            ,-0.648828416795,0.753826293558,-0.249551448842,-0.845864157435,1.753806409259,1.438283153409,-1.522557864083,4.282560900428,-3.057798813570,2.472986620640,0.011358928243,0.841083066090 &
            ,-0.650181438750,-0.626971527287,1.710798436875,-5.281111856784,-3.704700298903,0.733435026672,0.005202995697,-0.678070647065,-0.183846786129,1.483436971545,-0.114342916247,0.245177662462 &
            ,-4.958672977308,-2.488732735673,-0.018234714774,-0.567102951254,-1.201210482572,1.127781296358,-2.767243399254,-3.686532096648,-3.365216093337,-2.027184899872,-0.009926079453,-0.651752015929 &
            ,-0.455911448913,-0.272115205455,-3.282243355015,-3.535112534177,-4.855544434475,0.588722807739,-0.001404914040,-1.334053370678,0.430704431778,2.768346680246,-5.405828350974,-2.083098221376 &
            ,-3.753141397654,0.318386962379,-0.041150372582,-0.413251389870,0.797715300028,1.283215163483,-9.946245920628,0.926549737853,-1.943965967565,0.943870716307,0.022606601079,0.644902801328 &
            ,1.774232171281,-0.081250077220,-16.453849876156,-1.728608090174,-2.653155118722,-0.106202761119,0.018234468988,-0.827898338239,0.784740357742,0.622852767516,-23.245623284808,-1.898743851780 &
            ,0.774059895293,-1.578741192935,0.005219015050,0.255957836258,-0.256659503903,2.391450129725,-18.602546867984,-2.387882506323,-0.634209895299,-0.142089115699,0.051133463258,-1.519696669594 &
            ,-0.862825650202,5.174225896889,-10.119795220564,0.898456201045,-0.780149830401,0.133995643245,-0.002662036412,-0.733849174154,0.183735619146,0.884023982426,-0.253319139276,0.206267876867 &
            ,0.059386543086,0.149305732547,0.001097902426,0.237915759544,-0.361315147674,0.578850217290,-0.377107618066,0.155230095902,-0.278263393451,-0.310109151466,-0.000917891832,-0.092586494957 &
            ,-0.082493479281,0.987978111882,0.139268940470,-0.217251054325,-0.126836445377,0.838090722512,-0.009242283081,0.036349147250,0.097879566097,0.971642535886,-0.811061593675,0.013363880552 &
            ,0.239561379699,0.357866718911,-0.021035041947,0.419912488767,0.357574142813,0.861115647161,-0.213413562137,-0.077627138326,-0.545613136273,0.190022674511,-0.009539769822,-0.377754957660 &
            ,0.269834458778,1.028357477631,-0.868075802475,-0.299926558299,-0.137443767692,-0.189979064771,-0.001878805544,0.113460416192,0.109983129272,1.022434635911,0.296095655205,0.515322925855 &
            ,0.421385691838,0.089977550612,0.006681256471,1.006779404872,0.382964996777,-0.470628242079,0.190995417578,0.028609016452,1.390034940410,-1.556248279074,0.060022671897,0.066720604984 &
            ,-0.254878855206,-7.247373384630,0.326346709310,-7.797942079216,-1.249084726545,-1.198094868338,0.007650154491,3.276226728398,-0.289496800665,-2.061183108484,-0.026188418376,2.154481362224 &
            ,0.484653575564,0.766968133425,-0.024994350528,6.367364846286,0.299299292335,-5.180016878427,0.214327984182,-1.021470439420,4.055343995384,-0.042699057788,0.011379751808,7.383085869858 &
            ,-0.717246057679,-14.945845381847,0.620826211084,-2.351470449543,1.178653988922,-0.020275199371,-0.013390517930,9.396600272453,0.018587526728,-7.048046481699,0.306036082679,4.071422553821 &
            ,-3.037531247819,0.390812933535,0.004299278785,8.161321973744,0.262340060887,1.942037519673,0.663417055046,-1.739463755211,3.830259100835,-0.169864273950,0.015176108134,5.340045355064 &
            ,-0.158852351782,-0.337850488400,1.151085554313,-1.561398132847,1.110133271972,-0.207036259669,-0.005788974871,3.851083483769,-0.355807593226,-11.099620003813,2.142965643942,1.466482408518 &
            ,-1.605838844776,-0.796293253000,0.009596983533,3.801045875789,-0.143847541314,-11.303709308182,1.800792998827,2.188740232854,-3.794693835200,-0.120717882458,0.001162282283,4.111225738509 &
            ,-0.691181844454,-7.096574105145,1.860476110856,-3.605854287886,-1.335176858624,0.212956895280,0.005390184964,5.008478690284,-0.090401789817,-1.925806377149,0.099655707491,-2.067592220772 &
            ,1.264829834101,-0.162067465350,0.010330600680,0.733136621785,-0.100774153546,-1.133246168136,0.108027157567,-0.261539821045,0.717695240735,0.276668677386,-0.007347644420,0.408545439194 &
            ,-0.076602425850,-1.487933846564,0.046412344183,0.142149499675,-0.336052904064,-0.297425595876,0.007051056403,0.247696823070,-0.344650546091,-1.957694589722,0.117828071995,-0.800506973804 &
            ,-0.099821529771,0.150261508362,-0.013637178651,0.415698422878,-0.155835502939,-1.104720550317,0.235309999547,-1.810769784097,0.969041338965,-0.136540395027,0.004077593130,0.407080361220 &
            ,-0.175904347832,-1.281219464166,0.516245225350,-1.872133416484,2.673388961316,-0.349405541104,0.029739963944,1.280107826910,-0.819347696230,-2.053496357592,0.680016696623,-2.155280737841 &
            ,2.192742178664,-0.361942201367,0.015227670029,0.728470599546,-0.291849473075,-3.993959691016,0.739522068809,-1.420800346898,4.141867638717,-1.320968974239,0.035126004929,1.267965812026 &
            ,-0.000393431684,-0.966593491571,-0.011055381954,-0.131825581986,-0.314630735369,0.229416764906,-0.001773447784,-0.251674760275,-0.172568775637,-0.647353410843,0.072150379182,0.705097748404 &
            ,-1.019098231189,0.009510703128,-0.005438062410,-0.197248218582,0.099539068905,-0.145318652127,-0.041164100598,-1.116564923158,0.293071508547,-0.091809378060,0.004489029192,0.737458315891 &
            ,0.084924093336,-0.202603156613,-0.006704313081,-1.902220697241,1.318175614189,-0.205409434296,0.007133726146,1.035439163986,-0.094846784180,-0.305565990069,0.058636602119,-1.814032929651 &
            ,0.867510700146,0.011012740197,-0.000663513222,-0.043928105607,0.064034292300,-0.926525557101,-0.106623758828,-2.255631985427,1.365230732036,0.028219186631,0.000820644086,-0.980415703838 &
            ,0.009310161918,-0.289119752088,-0.046421878552,-3.359067321009,0.995143479034,0.145307833003,-0.002421614151,-0.626701272676,-0.043446405188,0.988999326562,-0.052025968870,-1.298926483522 &
            ,-0.576317442735,0.013995342452,0.000435423102,0.255119083748,0.049515700696,0.140581107316,-0.266596007646,-0.048572194197,-0.877615465287,0.066593669484,-0.000677166847,0.365274890334 &
            ,-0.064049565229,-0.509308030127,-0.288560297066,-1.201696719110,-0.394594993788,-0.285643348277,0.002181471486,0.448317065947,-0.013301484350,0.052420567013,-0.024284433876,-0.058323447990 &
            ,-0.226186904645,-0.069765904719,-0.001443693661,-0.025667973305,-0.046325612043,-0.071617675918,-0.019609139291,-0.107023343041,0.041213561910,0.027108929416,-0.001848733355,0.061183149833 &
            ,-0.030243468386,0.007883206794,-0.019439183364,-0.058557940255,0.037224683187,-0.005377157419,-0.001525539055,0.140670736194,0.095545267865,-0.034605641305,-0.051105316743,-0.039443656604 &
            ,-0.019784452947,-0.069927575368,0.004202891701,0.063549422135,0.005548669160,-0.019344851156,-0.011676437981,-0.070433999253,-0.236849051611,-0.014082937161,-0.000905651135,0.021979070538 &
            ,0.031590198762,0.010607791361,-0.026803332076,-0.003169673504,-0.404210732967,0.016600619196,-0.000312772294,-0.032547478277,-0.076113192440,0.065393212830,0.045065819266,-0.036996931697 &
            ,-0.466356717906,-0.003242001882,-0.001338902696,-0.077560104998,0.093485745731,-0.267394112031,-0.053425615111,0.120245699413,0.346345020097,-0.010005343398,0.003857657468,0.178848003447 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/2.64,-2.847 &
            ,16.332,-21.5145,-2.4653,-3.6995 &
            ,23.461,-23.373 &
            ,15.5444,-15.3434 &
            ,2.6472,-2.2818 &
            ,4.2335,2.9977 &
            ,-15.9893,15.2559 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-8.7139,-8.5526/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/6.9799,-2.1039,1.4883,-4.0098,2.8249,-3.1901,1.2374,-6.5483/)
real, dimension(2) :: bias2 = &
  (/-7.4377,2.8093/)
real, dimension(1) :: bias3 = &
  (/8.8123/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
